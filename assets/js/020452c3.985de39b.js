"use strict";(self.webpackChunkpathom_3_docs=self.webpackChunkpathom_3_docs||[]).push([[151],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),d=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=d(e.components);return o.createElement(s.Provider,{value:t},e.children)},l="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),l=d(n),u=a,h=l["".concat(s,".").concat(u)]||l[u]||m[u]||i;return n?o.createElement(h,r(r({ref:t},p),{},{components:n})):o.createElement(h,r({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=u;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c[l]="string"==typeof e?e:a,r[1]=c;for(var d=2;d<i;d++)r[d]=n[d];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},50:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var o=n(7462),a=(n(7294),n(3905));const i={id:"indexes",title:"Indexes"},r=void 0,c={unversionedId:"indexes",id:"indexes",title:"Indexes",description:"To make efficient lookups, Pathom uses a series of indexes generated from the user",source:"@site/docs/indexes.mdx",sourceDirName:".",slug:"/indexes",permalink:"/docs/indexes",draft:!1,editUrl:"https://github.com/wilkerlucio/pathom3-docs/edit/master/docs/indexes.mdx",tags:[],version:"current",frontMatter:{id:"indexes",title:"Indexes"},sidebar:"docs",previous:{title:"Dynamic Resolvers",permalink:"/docs/dynamic-resolvers"},next:{title:"Planner",permalink:"/docs/planner"}},s={},d=[{value:"index-oir",id:"index-oir",level:2},{value:"index-io",id:"index-io",level:2},{value:"index-attributes",id:"index-attributes",level:2},{value:"<code>:com.wsscode.pathom3.connect.indexes/attr-id</code>",id:"comwsscodepathom3connectindexesattr-id",level:4},{value:"<code>:com.wsscode.pathom3.connect.indexes/attr-input-in</code>",id:"comwsscodepathom3connectindexesattr-input-in",level:4},{value:"<code>:com.wsscode.pathom3.connect.indexes/attr-output-in</code>",id:"comwsscodepathom3connectindexesattr-output-in",level:4},{value:"<code>:com.wsscode.pathom3.connect.indexes/attr-provides</code>",id:"comwsscodepathom3connectindexesattr-provides",level:4},{value:"<code>:com.wsscode.pathom3.connect.indexes/attr-reach-via</code>",id:"comwsscodepathom3connectindexesattr-reach-via",level:4},{value:"<code>:com.wsscode.pathom3.connect.indexes/attr-combinations</code>",id:"comwsscodepathom3connectindexesattr-combinations",level:4},{value:"index-resolvers",id:"index-resolvers",level:2}],p={toc:d},l="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(l,(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"To make efficient lookups, Pathom uses a series of indexes generated from the user\n",(0,a.kt)("a",{parentName:"p",href:"/docs/resolvers"},"resolvers"),"."),(0,a.kt)("h2",{id:"index-oir"},"index-oir"),(0,a.kt)("p",null,"This is the most important index to understand how Pathom processes the data."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"oir")," stands for ",(0,a.kt)("inlineCode",{parentName:"p"},"output")," \u2192 ",(0,a.kt)("inlineCode",{parentName:"p"},"input")," \u2192 ",(0,a.kt)("inlineCode",{parentName:"p"},"resolver"),"."),(0,a.kt)("p",null,"In other words, this is the index that tells Pathom which are the paths available to\nreach a given attribute in the system."),(0,a.kt)("p",null,"Let's look at an example and talk over it:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-clojure"},"; for this resolver\n(pco/defresolver product-by-id [{:keys [acme.product/id]}]\n  {::pco/input  [:acme.product/id]\n   ::pco/output [:acme.product/name\n                 :acme.product/price\n                 :acme.product/in-stock?]}\n  (fetch-product id))\n\n; we get this index-oir\n{:com.wsscode.pathom3.connect.indexes/index-oir\n {:acme.product/name      {{:acme.product/id {}} #{product-by-id}}\n  :acme.product/price     {{:acme.product/id {}} #{product-by-id}}\n  :acme.product/in-stock? {{:acme.product/id {}} #{product-by-id}}}}\n")),(0,a.kt)("p",null,"With this index, Pathom can ask: How can I fetch ",(0,a.kt)("inlineCode",{parentName:"p"},":acme.product/price")," in the system?\nFor which the answer is:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-clojure"},"{{:acme.product/id {}} #{product-by-id}}\n")),(0,a.kt)("p",null,"Or in plain english: The index says you can fetch the product price, given you provide some\nproduct id, using the edge ",(0,a.kt)("inlineCode",{parentName:"p"},"product-by-id"),"."),(0,a.kt)("p",null,"The input in this index uses the ",(0,a.kt)("a",{parentName:"p",href:"/docs/shape-descriptor"},"shape descriptor")," format."),(0,a.kt)("p",null,"This is an overview of this index, for more details on how the planner uses it, check\nthe ",(0,a.kt)("a",{parentName:"p",href:"/docs/planner"},"planner page"),"."),(0,a.kt)("h2",{id:"index-io"},"index-io"),(0,a.kt)("p",null,"This index tells, for given attribute set (with empty, one or more items), which attributes\nare ",(0,a.kt)("strong",{parentName:"p"},"directly reachable")," (one resolver distance) from that set."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"io")," stands for ",(0,a.kt)("inlineCode",{parentName:"p"},"input")," \u2192 ",(0,a.kt)("inlineCode",{parentName:"p"},"output"),"."),(0,a.kt)("p",null,"Here is what ",(0,a.kt)("inlineCode",{parentName:"p"},"index-io")," looks like, using the same resolver from our previous example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-clojure"},"{:com.wsscode.pathom3.connect.indexes/index-io\n {#{:acme.product/id}\n  {:acme.product/name      {}\n   :acme.product/price     {}\n   :acme.product/in-stock? {}}}}\n")),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"output")," part uses the ",(0,a.kt)("a",{parentName:"p",href:"/docs/shape-descriptor"},"shape descriptor")," format."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/docs/smart-maps"},"Smart maps"),' use this index to figure reachable attributes when used in "reachable mode".'),(0,a.kt)("p",null,"This is a good index to create auto-complete features in editors for Pathom integration."),(0,a.kt)("h2",{id:"index-attributes"},"index-attributes"),(0,a.kt)("p",null,"This index contains accumulated information about how a specific attribute relates to\nother attributes and resolvers."),(0,a.kt)("p",null,"Let's use the ",(0,a.kt)("inlineCode",{parentName:"p"},"full-name")," resolver example to demonstrate the index-attributes at play:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-clojure"},'(pco/defresolver full-name [{::keys [first-name last-name]}]\n  {::full-name (str first-name " " last-name)})\n\n{:com.wsscode.pathom3.connect.indexes/index-attributes\n {#{::first-name ::last-name} {:com.wsscode.pathom3.connect.indexes/attr-id       #{::first-name ::last-name}\n                               :com.wsscode.pathom3.connect.indexes/attr-provides {::full-name #{:full-name}}\n                               :com.wsscode.pathom3.connect.indexes/attr-input-in #{full-name}}\n  ::first-name                {:com.wsscode.pathom3.connect.indexes/attr-id           ::first-name\n                               :com.wsscode.pathom3.connect.indexes/attr-combinations #{#{::first-name ::last-name}}\n                               :com.wsscode.pathom3.connect.indexes/attr-input-in     #{full-name}}\n  ::last-name                 {:com.wsscode.pathom3.connect.indexes/attr-id           ::last-name\n                               :com.wsscode.pathom3.connect.indexes/attr-combinations #{#{::first-name ::last-name}}\n                               :com.wsscode.pathom3.connect.indexes/attr-input-in     #{full-name}}\n  ::full-name                 {:com.wsscode.pathom3.connect.indexes/attr-id        ::full-name\n                               :com.wsscode.pathom3.connect.indexes/attr-reach-via {#{::first-name ::last-name} #{full-name}}\n                               :com.wsscode.pathom3.connect.indexes/attr-output-in #{full-name}}}}\n')),(0,a.kt)("p",null,"The first level of the index is the attribute itself, the details we can explain key by\nkey:"),(0,a.kt)("h4",{id:"comwsscodepathom3connectindexesattr-id"},(0,a.kt)("inlineCode",{parentName:"h4"},":com.wsscode.pathom3.connect.indexes/attr-id")),(0,a.kt)("p",null,"Contains the ID of the attribute, it may be a keyword (as seen in the example) or also\na set in cases of attribute combinations."),(0,a.kt)("h4",{id:"comwsscodepathom3connectindexesattr-input-in"},(0,a.kt)("inlineCode",{parentName:"h4"},":com.wsscode.pathom3.connect.indexes/attr-input-in")),(0,a.kt)("p",null,"A set containing a list of all resolvers in which this attribute appears as an input."),(0,a.kt)("h4",{id:"comwsscodepathom3connectindexesattr-output-in"},(0,a.kt)("inlineCode",{parentName:"h4"},":com.wsscode.pathom3.connect.indexes/attr-output-in")),(0,a.kt)("p",null,"A set containing a list of all resolvers in which this attribute appears as an output."),(0,a.kt)("h4",{id:"comwsscodepathom3connectindexesattr-provides"},(0,a.kt)("inlineCode",{parentName:"h4"},":com.wsscode.pathom3.connect.indexes/attr-provides")),(0,a.kt)("p",null,"This is a sub-index, telling what other attributes are reachable from this attribute, by\nwhich resolver."),(0,a.kt)("h4",{id:"comwsscodepathom3connectindexesattr-reach-via"},(0,a.kt)("inlineCode",{parentName:"h4"},":com.wsscode.pathom3.connect.indexes/attr-reach-via")),(0,a.kt)("p",null,"This is a sub-index, telling what other attributes you can use to reach the current, by\nwhich resolver."),(0,a.kt)("h4",{id:"comwsscodepathom3connectindexesattr-combinations"},(0,a.kt)("inlineCode",{parentName:"h4"},":com.wsscode.pathom3.connect.indexes/attr-combinations")),(0,a.kt)("p",null,"A set with all the input combinations that this attribute appears in."),(0,a.kt)("h2",{id:"index-resolvers"},"index-resolvers"),(0,a.kt)("p",null,"In this index you can lookup resolvers by their name. Using both ",(0,a.kt)("inlineCode",{parentName:"p"},"product-by-id")," and\n",(0,a.kt)("inlineCode",{parentName:"p"},"full-name")," resolvers, this is what the ",(0,a.kt)("inlineCode",{parentName:"p"},"index-resolvers")," looks like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-clojure"},"{:com.wsscode.pathom3.connect.indexes/index-resolvers\n {product-by-id\n  #com.wsscode.pathom3.connect.operation.Resolver\n  {:config  {:com.wsscode.pathom3.connect.operation/input    [:acme.product/id]\n             :com.wsscode.pathom3.connect.operation/requires {:acme.product/id {}}\n             :com.wsscode.pathom3.connect.operation/output   [:acme.product/name :acme.product/price :acme.product/in-stock?]\n             :com.wsscode.pathom3.connect.operation/provides {:acme.product/name      {}\n                                                              :acme.product/price     {}\n                                                              :acme.product/in-stock? {}}\n             :com.wsscode.pathom3.connect.operation/op-name  product-by-id}\n   :resolve product-by-id--23075}\n\n  full-name\n  #com.wsscode.pathom3.connect.operation.Resolver\n  {:config  {:com.wsscode.pathom3.connect.operation/input    [::first-name ::last-name]\n             :com.wsscode.pathom3.connect.operation/requires {::first-name {} ::last-name {}}\n             :com.wsscode.pathom3.connect.operation/output   [::full-name]\n             :com.wsscode.pathom3.connect.operation/provides {::full-name {}}\n             :com.wsscode.pathom3.connect.operation/op-name  full-name}\n   :resolve full-name--23079}}}\n")))}m.isMDXComponent=!0}}]);