<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-smart-maps" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Smart Maps | Pathom 3</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pathom3.wsscode.com/docs/smart-maps"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Smart Maps | Pathom 3"><meta data-rh="true" name="description" content="Smart maps are a custom map type powered by Pathom resolvers."><meta data-rh="true" property="og:description" content="Smart maps are a custom map type powered by Pathom resolvers."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pathom3.wsscode.com/docs/smart-maps"><link data-rh="true" rel="alternate" href="https://pathom3.wsscode.com/docs/smart-maps" hreflang="en"><link data-rh="true" rel="alternate" href="https://pathom3.wsscode.com/docs/smart-maps" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://8YW0ZACTDN-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GZFCYV0DXN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-GZFCYV0DXN",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Pathom 3" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.5e9cce91.css">
<link rel="preload" href="/assets/js/runtime~main.7be6ae2a.js" as="script">
<link rel="preload" href="/assets/js/main.670c6fc5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/icon_64x64.png" alt="Pathom 3" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/icon_64x64.png" alt="Pathom 3" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Pathom 3</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://blog.wsscode.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/media">Media</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wilkerlucio/pathom3" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorial">Pathom Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/nouns">Nouns</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/resolvers">Using Pathom</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/resolvers">Resolvers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/built-in-resolvers">Built-in Resolvers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/smart-maps">Smart Maps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/eql">EQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/environment">Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cache">Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/placeholders">Placeholders</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/mutations">Mutations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/error-handling">Error Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins">Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/built-in-plugins">Built-in Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/async">Async</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/debugging">Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/foreign">Foreign Environments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamic-resolvers">Dynamic Resolvers</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/indexes">How Pathom Works</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/integrations/graphql">Integrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tutorials/hacker-news-scraper">Tutorials</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Using Pathom</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Smart Maps</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Smart Maps</h1></header><p>Smart maps are a custom map type powered by Pathom resolvers.</p><p>With smart maps, you can leverage the power of Pathom processing using the accessible
standard Clojure map interfaces.</p><h2 id="using-smart-maps">Using smart maps</h2><p>To create a smart map, we need the indexes with resolvers, here is a basic example:</p><pre><code class="language-clojure">(ns com.wsscode.pathom.docs.smart-maps-demo
  (:require [com.wsscode.pathom3.connect.indexes :as pci]
            [com.wsscode.pathom3.connect.operation :as pco]
            [com.wsscode.pathom3.interface.smart-map :as psm]))

(pco/defresolver full-name [{::keys [first-name last-name]}]
  {::full-name (str first-name &quot; &quot; last-name)})

(def indexes (pci/register full-name))

(def person-data {::first-name &quot;Anne&quot; ::last-name &quot;Frank&quot;})

(def smart-map (psm/smart-map indexes person-data))

; if you lookup for a key in the initial data, it works the same way as a regular map
(::first-name smart-map) ; =&gt; &quot;Anne&quot;

; but when you read something that&#x27;s not there, it will trigger the Pathom engine to
; fulfill the attribute
(::full-name smart-map) ; =&gt; &quot;Anne Frank&quot;
</code></pre><p>When you start a smart map, Pathom creates an atom with the initial data, and then when
you request some new information, Pathom triggers the resolver engine, merges the result
in the same atom and returns the value for that key, effectively caching it.</p><p>This way, the subsequent accesses have the same speed as a local entry.</p><h3 id="nested-maps">Nested maps</h3><p>Nested map values are wrapped with a smart map using the same environment configuration. For example:</p><pre><code class="language-clojure">(pco/defresolver full-name [{::keys [first-name last-name]}]
  {::full-name (str first-name &quot; &quot; last-name)})

(pco/defresolver anne []
  {::anne {::first-name &quot;Anne&quot; ::last-name &quot;Frank&quot;}})

(def indexes (pci/register [full-name anne]))

(def smart-map (psm/smart-map indexes))

(::anne smart-map) ; =&gt; {::first-name &quot;Anne&quot; ::last-name &quot;Frank&quot;}

; nested access
(-&gt; smart-map ::anne ::full-name) ; =&gt; &quot;Anne Frank&quot;
</code></pre><admonition type="important"><p>This only applies to native Clojure/script maps. It doesn&#x27;t wrap records and other
custom map types.</p></admonition><h3 id="nested-sequences">Nested sequences</h3><p>It also applies for maps inside sequences:</p><pre><code class="language-clojure">(pco/defresolver full-name [{::keys [first-name last-name]}]
  {::full-name (str first-name &quot; &quot; last-name)})

(pco/defresolver stars []
  {::star-wars-characters
   [{::first-name &quot;Luke&quot; ::last-name &quot;Skywalker&quot;}
    {::first-name &quot;Darth&quot; ::last-name &quot;Vader&quot;}
    {::first-name &quot;Han&quot; ::last-name &quot;Solo&quot;}]})

(def indexes (pci/register [full-name stars]))

(def smart-map (psm/smart-map indexes))

; nested access on sequences
(mapv ::full-name (::star-wars-characters smart-map))
; =&gt; [&quot;Luke Skywalker&quot;
;     &quot;Darth Vader&quot;
;     &quot;Han Solo&quot;]
</code></pre><admonition type="note"><p>Smart maps do the conversion of sequence items to smart maps on the sequence read. This
means that anytime you read a sequence on a smart map, if the sequence is a <code>vector</code>, that
scan will be done eagerly. Otherwise, it will use <code>map</code>, and the processing is lazy.</p></admonition><h3 id="error-modes">Error modes</h3><p>By default, if some error happens during the Pathom process, the Smart Map is going
to be silent about it. You can allow the errors to flow up by using the <code>psm/with-error-mode</code>
helper:</p><pre><code class="language-clojure">(pco/defresolver error-resolver []
  {:error (throw (ex-info &quot;Error&quot; {}))})

(let [sm (-&gt; (pci/register error-resolver)
             (psm/with-error-mode ::psm/error-mode-loud)
             (psm/smart-map))]
  (:error sm))
; =&gt; Execution error (ExceptionInfo) at ...
;    Error
</code></pre><p>The options for error mode are:</p><ul><li><code>::psm/error-mode-silent</code> (default): Return <code>nil</code> as the value, don&#x27;t throw errors.</li><li><code>::psm/error-mode-loud</code>: Throw the errors on read.</li></ul><h3 id="disable-nested-wrap">Disable nested wrap</h3><p>You can disable the automatic nest wrap using <code>(psm/with-wrap-nested? false)</code> in the env.</p><pre><code class="language-clojure">(psm/smart-map (-&gt; indexes
                   (psm/with-wrap-nested? false)
  {:initial-data &quot;value&quot;}))
</code></pre><p>Then all values will return as-is.</p><admonition type="tip"><p>You can manually wrap nested values in the same way the library does by using the same
env on the value, for example:</p><pre><code class="language-clojure">(psm/smart-map (psm/sm-env smart-map) (::map-value smart-map))
</code></pre></admonition><h3 id="preload-data">Preload data</h3><p>If you know the attributes you will need ahead of time, it&#x27;s more efficient to load then
in a single run than fetching one by one lazily.</p><p>You can accomplish this using the fn <code>psm/touch!</code>, example:</p><pre><code class="language-clojure">(pco/defresolver right [{::keys [left width]}]
  {::right (+ left width)})

(pco/defresolver bottom [{::keys [top height]}]
  {::bottom (+ top height)})

(def indexes (pci/register [right bottom]))

(def square {::left  10 ::top 30
             ::width 23 ::height 35})

(def smart-map
  (-&gt; (psm/smart-map indexes square)
      (psm/sm-touch! [::right ::bottom])))

(::right smart-map) ; =&gt; 33, read from cache
(::bottom smart-map) ; =&gt; 65, read from cache
</code></pre><admonition type="tip"><p>You can also use <code>psm/sm-touch-ast!</code> to provide an AST directly.</p></admonition><h2 id="keys-modes">Keys modes</h2><p>Smart Maps keys mode is a configuration to decide how a smart map respond to <code>(keys smart-map)</code></p><p>To change this, use the helper <code>(psm/with-keys-mode ...)</code>, these are the available options
for it:</p><ul><li><code>::psm/keys-mode-cached</code> - the default option, <code>keys</code> will return the keys cached
in the internal smart map atom.</li><li><code>::psm/keys-mode-reachable</code> - <code>keys</code> will return all possible keys that are reachable
from the current data and the index.</li></ul><admonition type="danger"><p>Be careful with <code>::psm/keys-mode-reachable</code> combined with enabled &quot;nested wrapping&quot;.
Considering that, depending on the index and the current data, a simple <code>print</code> of the
smart map can lead to infinite loops due to smart maps&#x27; recursive properties.</p></admonition><h2 id="changes-to-smart-maps">Changes to smart maps</h2><p>You can use the change operations of maps in the smart map (<code>assoc</code>, <code>dissoc</code>, ...).</p><p>When a change operation happens, you get a new smart map. Be aware this new smart map
doesn&#x27;t have the cached data from resolvers from the previous one. The modification is
done from the <code>source map</code>, the one used to create the smart map in the first place.</p><p>This is important so any data computed by resolvers can react to the changes based on
the new data context. The following example illustrates this behavior:</p><pre><code class="language-clojure">(pco/defresolver full-name [{::keys [first-name last-name]}]
  {::full-name (str first-name &quot; &quot; last-name)})

(def indexes (pci/register full-name))

(def person-data {::first-name &quot;John&quot; ::last-name &quot;Lock&quot;})

(def smart-map (psm/smart-map indexes person-data))

(::full-name smart-map) ; =&gt; &quot;John Lock&quot;

(-&gt; smart-map
    (assoc ::last-name &quot;Oliver&quot;)
    ::full-name)
; =&gt; &quot;John Oliver&quot;, the full-name gets re-computed due to the change
</code></pre><h2 id="inside-smart-maps">Inside smart maps</h2><p>The smart map data structure contains an <a href="/docs/environment">environment</a> inside of it, there
you can find the <a href="/docs/indexes">indexes</a>, the cached data, and any other relevant options that
make the setup of the smart map.</p><p>You can access the smart map environment using <code>psm/sm-env</code>. This includes all the data
you sent as <code>env</code> during the smart map creation, plus the cache atom.</p><h2 id="debugging-reads">Debugging reads</h2><p>Sometimes the result will be unexpected, to debug the smart map you can use the <code>psm/sm-get-with-stats</code>
function to return the run stats of the process:</p><pre><code class="language-clojure">(def indexes
  (pci/register
    [(pbir/constantly-resolver ::n 10)
     (pbir/single-attr-resolver ::n ::x inc)
     (pbir/single-attr-resolver ::x ::y #(* % 2))
     (pbir/single-attr-resolver ::y ::z #(- % 10))]))

(-&gt; (psm/smart-map indexes)
    (psm/sm-get-with-stats ::y))
;{:com.wsscode.pathom3.connect.planner/index-attrs #:com.wsscode.pathom.docs.smart-maps-demo{:n #{3},
;                                                                                            :y #{1},
;                                                                                            :x #{2}},
; :com.wsscode.pathom3.connect.planner/unreachable-attrs {},
; :com.wsscode.pathom3.connect.runner/graph-process-duration-ms 0.11225199699401855,
; :com.wsscode.pathom3.connect.runner.stats/overhead-duration-ms 0.09637504816055298,
; :com.wsscode.pathom3.connect.planner/root 3,
; :com.wsscode.pathom3.connect.runner.stats/overhead-duration-percentage 0.8585597650052356,
; :com.wsscode.pathom3.connect.runner/node-run-stats {1 #:com.wsscode.pathom3.connect.runner{:run-duration-ms 0.006672978401184082,
;                                                                                            :node-run-input #:com.wsscode.pathom.docs.smart-maps-demo{:x 11}},
;                                                     3 #:com.wsscode.pathom3.connect.runner{:run-duration-ms 0.004477977752685547,
;                                                                                            :node-run-input {}},
;                                                     2 #:com.wsscode.pathom3.connect.runner{:run-duration-ms 0.004725992679595947,
;                                                                                            :node-run-input #:com.wsscode.pathom.docs.smart-maps-demo{:n 10}}},
; :com.wsscode.pathom3.connect.planner/index-ast #:com.wsscode.pathom.docs.smart-maps-demo{:y {:key :com.wsscode.pathom.docs.smart-maps-demo/y,
;                                                                                              :type :prop,
;                                                                                              :dispatch-key :com.wsscode.pathom.docs.smart-maps-demo/y}},
; :com.wsscode.pathom3.connect.planner/unreachable-resolvers #{},
; :com.wsscode.pathom3.interface.smart-map/value 22,
; :com.wsscode.pathom3.connect.planner/index-resolver-&gt;nodes {com.wsscode.pathom.docs.smart_maps_demo_SLASH_x-&gt;com.wsscode.pathom.docs.smart_maps_demo_SLASH_y-single-attr-transform #{1},
;                                                             com.wsscode.pathom.docs.smart_maps_demo_SLASH_n-constant #{3},
;                                                             com.wsscode.pathom.docs.smart_maps_demo_SLASH_n-&gt;com.wsscode.pathom.docs.smart_maps_demo_SLASH_x-single-attr-transform #{2}},
; :com.wsscode.pathom3.connect.planner/nodes {1 {:com.wsscode.pathom3.connect.planner/after-nodes #{2},
;                                                :com.wsscode.pathom3.connect.planner/requires #:com.wsscode.pathom.docs.smart-maps-demo{:y {}},
;                                                :com.wsscode.pathom3.connect.operation/op-name com.wsscode.pathom.docs.smart_maps_demo_SLASH_x-&gt;com.wsscode.pathom.docs.smart_maps_demo_SLASH_y-single-attr-transform,
;                                                :com.wsscode.pathom3.connect.planner/source-for-attrs #{:com.wsscode.pathom.docs.smart-maps-demo/y},
;                                                :com.wsscode.pathom3.connect.planner/input #:com.wsscode.pathom.docs.smart-maps-demo{:x {}},
;                                                :com.wsscode.pathom3.connect.planner/node-id 1},
;                                             3 {:com.wsscode.pathom3.connect.planner/requires #:com.wsscode.pathom.docs.smart-maps-demo{:n {}},
;                                                :com.wsscode.pathom3.connect.operation/op-name com.wsscode.pathom.docs.smart_maps_demo_SLASH_n-constant,
;                                                :com.wsscode.pathom3.connect.planner/source-for-attrs #{:com.wsscode.pathom.docs.smart-maps-demo/n},
;                                                :com.wsscode.pathom3.connect.planner/input {},
;                                                :com.wsscode.pathom3.connect.planner/run-next 2,
;                                                :com.wsscode.pathom3.connect.planner/node-id 3},
;                                             2 {:com.wsscode.pathom3.connect.planner/after-nodes #{3},
;                                                :com.wsscode.pathom3.connect.planner/requires #:com.wsscode.pathom.docs.smart-maps-demo{:x {}},
;                                                :com.wsscode.pathom3.connect.operation/op-name com.wsscode.pathom.docs.smart_maps_demo_SLASH_n-&gt;com.wsscode.pathom.docs.smart_maps_demo_SLASH_x-single-attr-transform,
;                                                :com.wsscode.pathom3.connect.planner/source-for-attrs #{:com.wsscode.pathom.docs.smart-maps-demo/x},
;                                                :com.wsscode.pathom3.connect.planner/input #:com.wsscode.pathom.docs.smart-maps-demo{:n {}},
;                                                :com.wsscode.pathom3.connect.planner/run-next 1,
;                                                :com.wsscode.pathom3.connect.planner/node-id 2}},
; :com.wsscode.pathom3.connect.runner.stats/resolver-accumulated-duration-ms 0.015876948833465576}
</code></pre><h2 id="smart-maps-caching">Smart Maps caching</h2><p>Smart maps use a durable form of the cache by default. The smart maps add the caches
at initialization, and they are persisted when variations of that Smart Map are created.</p><p>This means, for example, when you <code>assoc</code> on a Smart Map, the new returned Smart Map still shares the same plan and resolver caches.</p><h2 id="datafy">Datafy</h2><p>Smart Maps support the Clojure Datafy / Navigate protocols. This means if you use a REPL
visualizer like <a href="https://vlaaad.github.io/reveal/">Reveal</a> or <a href="https://docs.datomic.com/cloud/other-tools/REBL.html">REBL</a>
you can navigate the projected data from the Smart Map lazily.</p><p>To demonstrate I&#x27;ll be showing its usage with Reveal in the following video:</p><iframe width="560" height="315" src="https://www.youtube.com/embed/n_MJOKEqqnM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><p>Also in REBL:</p><iframe width="560" height="315" src="https://www.youtube.com/embed/v4vzdLRrkr8" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wilkerlucio/pathom3-docs/edit/master/docs/smart-maps.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/built-in-resolvers"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Built-in Resolvers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/eql"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">EQL</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#using-smart-maps" class="table-of-contents__link toc-highlight">Using smart maps</a><ul><li><a href="#nested-maps" class="table-of-contents__link toc-highlight">Nested maps</a></li><li><a href="#nested-sequences" class="table-of-contents__link toc-highlight">Nested sequences</a></li><li><a href="#error-modes" class="table-of-contents__link toc-highlight">Error modes</a></li><li><a href="#disable-nested-wrap" class="table-of-contents__link toc-highlight">Disable nested wrap</a></li><li><a href="#preload-data" class="table-of-contents__link toc-highlight">Preload data</a></li></ul></li><li><a href="#keys-modes" class="table-of-contents__link toc-highlight">Keys modes</a></li><li><a href="#changes-to-smart-maps" class="table-of-contents__link toc-highlight">Changes to smart maps</a></li><li><a href="#inside-smart-maps" class="table-of-contents__link toc-highlight">Inside smart maps</a></li><li><a href="#debugging-reads" class="table-of-contents__link toc-highlight">Debugging reads</a></li><li><a href="#smart-maps-caching" class="table-of-contents__link toc-highlight">Smart Maps caching</a></li><li><a href="#datafy" class="table-of-contents__link toc-highlight">Datafy</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Presentations</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.youtube.com/watch?v=YaHiff2vZ_o" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Navigation with Pathom 3<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=IS3i3DTUnAI" target="_blank" rel="noopener noreferrer" class="footer__link-item">Conj 2019 - The Maximal Graph<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=yyVKf2U8YVg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Conj 2018 - Scaling Full Stack Applications<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=r3zywlNflJI" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dutch Clojure Days 2018 - Clojure Graph API’s<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://clojurians.slack.com/messages/pathom/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Wilker Lucio</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7be6ae2a.js"></script>
<script src="/assets/js/main.670c6fc5.js"></script>
</body>
</html>