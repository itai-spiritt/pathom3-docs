<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-resolvers">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GZFCYV0DXN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-GZFCYV0DXN",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Pathom 3" href="/opensearch.xml"><title data-rh="true">Resolvers | Pathom 3</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pathom3.wsscode.com/docs/resolvers"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Resolvers | Pathom 3"><meta data-rh="true" name="description" content="Resolvers are the primary building blocks in Pathom. In Pathom resolvers are used to"><meta data-rh="true" property="og:description" content="Resolvers are the primary building blocks in Pathom. In Pathom resolvers are used to"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pathom3.wsscode.com/docs/resolvers"><link data-rh="true" rel="alternate" href="https://pathom3.wsscode.com/docs/resolvers" hreflang="en"><link data-rh="true" rel="alternate" href="https://pathom3.wsscode.com/docs/resolvers" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://8YW0ZACTDN-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.50c9537c.css">
<link rel="preload" href="/assets/js/runtime~main.feaca457.js" as="script">
<link rel="preload" href="/assets/js/main.5057d4a7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/icon_64x64.png" alt="Pathom 3" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/icon_64x64.png" alt="Pathom 3" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Pathom 3</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://blog.wsscode.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/media">Media</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wilkerlucio/pathom3" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorial">Pathom Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/nouns">Nouns</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/resolvers">Using Pathom</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/resolvers">Resolvers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/built-in-resolvers">Built-in Resolvers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-maps">Smart Maps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/eql">EQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/environment">Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cache">Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/placeholders">Placeholders</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/mutations">Mutations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/error-handling">Error Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins">Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/built-in-plugins">Built-in Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/async">Async</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/debugging">Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/foreign">Foreign Environments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dynamic-resolvers">Dynamic Resolvers</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/indexes">How Pathom Works</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/integrations/graphql">Integrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tutorials/hacker-news-scraper">Tutorials</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Using Pathom</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Resolvers</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Resolvers</h1></header><p>Resolvers are the primary building blocks in Pathom. In Pathom resolvers are used to
express a relationship between attributes.</p><p>On this page, you will learn how to create resolvers and use them. After that you
will learn about the built-in resolvers that come with Pathom.</p><h2 id="what-is-a-resolver-in-pathom">What is a resolver in Pathom?</h2><p>The Pathom engine gathers its resolution features from the relationship between attributes.
Resolvers are the piece that expresses those relationships.</p><p>To put in more concrete terms, imagine that you have some user id, and you want to know
the user&#x27;s birth year. In Pathom, we express this relationship using the attributes
<code>:acme.user/id</code> and <code>:acme.user/birth-year</code> for example.</p><p>Now we need to implement how to fetch the name from the id, this can be a lookup in a
database, or a map, or any other way, doesn&#x27;t matter. What matters is that you express
this connection and provide code that makes it happen.</p><p>Here I&#x27;ll illustrate this using a map lookup:</p><pre><code class="language-clojure">(def user-birthdays
  {1 1969
   2 1954
   3 1986})

; defresolver is the main option to create new resolvers
(pco/defresolver user-birthday [{:keys [acme.user/id]}]
  {:acme.user/birth-year (get user-birthdays id)})
</code></pre><p>In Pathom, resolvers represent edges in a graph. As illustrated in the following figure:</p><div class="pathom-diagram"><p>  <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM6eGw9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjYxNSAzNzggNTIzIDE1OSIgd2lkdGg9IjUyMyIgaGVpZ2h0PSIxNTkiPgogIDxkZWZzPgogICAgPGZpbHRlciBpZD0iU2hhZG93IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHg9IjU2Mi43IiB5PSIzNjIuMSI+CiAgICAgIDxmZUdhdXNzaWFuQmx1ciBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0iYmx1ciIgc3RkRGV2aWF0aW9uPSIxLjMwOCIvPgogICAgICA8ZmVPZmZzZXQgaW49ImJsdXIiIHJlc3VsdD0ib2Zmc2V0IiBkeD0iMSIgZHk9IjMiLz4KICAgICAgPGZlRmxvb2QgZmxvb2QtY29sb3I9ImJsYWNrIiBmbG9vZC1vcGFjaXR5PSIuNSIgcmVzdWx0PSJmbG9vZCIvPgogICAgICA8ZmVDb21wb3NpdGUgaW49ImZsb29kIiBpbjI9Im9mZnNldCIgb3BlcmF0b3I9ImluIiByZXN1bHQ9ImNvbG9yIi8+CiAgICAgIDxmZU1lcmdlPgogICAgICAgIDxmZU1lcmdlTm9kZSBpbj0iY29sb3IiLz4KICAgICAgICA8ZmVNZXJnZU5vZGUgaW49IlNvdXJjZUdyYXBoaWMiLz4KICAgICAgPC9mZU1lcmdlPgogICAgPC9maWx0ZXI+CiAgICA8Zm9udC1mYWNlIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgcGFub3NlLTE9IjIgMCA1IDMgMCAwIDAgMiAwIDQiIHVuaXRzLXBlci1lbT0iMTAwMCIgdW5kZXJsaW5lLXBvc2l0aW9uPSItMTAwIiB1bmRlcmxpbmUtdGhpY2tuZXNzPSI1MCIgc2xvcGU9IjAiIHgtaGVpZ2h0PSI1MTciIGNhcC1oZWlnaHQ9IjcxNCIgYXNjZW50PSI5NTEuOTk1OCIgZGVzY2VudD0iLTIxMi45OTc0NCIgZm9udC13ZWlnaHQ9IjQwMCI+CiAgICAgIDxmb250LWZhY2Utc3JjPgogICAgICAgIDxmb250LWZhY2UtbmFtZSBuYW1lPSJIZWx2ZXRpY2FOZXVlIi8+CiAgICAgIDwvZm9udC1mYWNlLXNyYz4KICAgIDwvZm9udC1mYWNlPgogICAgPG1hcmtlciBvcmllbnQ9ImF1dG8iIG92ZXJmbG93PSJ2aXNpYmxlIiBtYXJrZXJVbml0cz0ic3Ryb2tlV2lkdGgiIGlkPSJGaWxsZWRBcnJvd19NYXJrZXIiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgdmlld0JveD0iLTEgLTMgNyA2IiBtYXJrZXJXaWR0aD0iNyIgbWFya2VySGVpZ2h0PSI2IiBjb2xvcj0id2hpdGUiPgogICAgICA8Zz4KICAgICAgICA8cGF0aCBkPSJNIDQuOCAwIEwgMCAtMS44IEwgMCAxLjggWiIgZmlsbD0iY3VycmVudENvbG9yIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgICAgIDwvZz4KICAgIDwvbWFya2VyPgogIDwvZGVmcz4KICA8bWV0YWRhdGE+IFByb2R1Y2VkIGJ5IE9tbmlHcmFmZmxlIDcuMTcuNVxuMjAyMC0xMC0wNSAyMDo0NTowNiArMDAwMDwvbWV0YWRhdGE+CiAgPGcgaWQ9IkNhbnZhc18xIiBmaWxsPSJub25lIiBzdHJva2Utb3BhY2l0eT0iMSIgZmlsbC1vcGFjaXR5PSIxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS1kYXNoYXJyYXk9Im5vbmUiPgogICAgPHRpdGxlPkNhbnZhcyAxPC90aXRsZT4KICAgIDxnIGlkPSJDYW52YXNfMV9MYXllcl8xIj4KICAgICAgPHRpdGxlPkxheWVyIDE8L3RpdGxlPgogICAgICA8ZyBpZD0iR3JhcGhpY180IiBmaWx0ZXI9InVybCgjU2hhZG93KSI+CiAgICAgICAgPGNpcmNsZSBjeD0iNjkzIiBjeT0iNDU0LjUiIHI9Ijc1LjAwMDExOTg0MjY0MjIiIGZpbGw9IiNmZmZmYzAiLz4KICAgICAgICA8Y2lyY2xlIGN4PSI2OTMiIGN5PSI0NTQuNSIgcj0iNzUuMDAwMTE5ODQyNjQyMiIgc3Ryb2tlPSIjZjBmM2Y2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICAgIDx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDYzOCA0NDUuMjc2KSIgZmlsbD0iYmxhY2siPgogICAgICAgICAgPHRzcGFuIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjQwMCIgZmlsbD0iYmxhY2siIHg9IjMwLjQwOCIgeT0iMTUiPnVzZXIvaWQ8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgICA8ZyBpZD0iR3JhcGhpY181IiBmaWx0ZXI9InVybCgjU2hhZG93KSI+CiAgICAgICAgPGNpcmNsZSBjeD0iMTA1Ny41IiBjeT0iNDU0LjUiIHI9Ijc1LjAwMDExOTg0MjY0MjEiIGZpbGw9IiNmZmZmYzAiLz4KICAgICAgICA8Y2lyY2xlIGN4PSIxMDU3LjUiIGN5PSI0NTQuNSIgcj0iNzUuMDAwMTE5ODQyNjQyMSIgc3Ryb2tlPSIjZjBmM2Y2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICAgIDx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMDIuNSA0NDUuMjc2KSIgZmlsbD0iYmxhY2siPgogICAgICAgICAgPHRzcGFuIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjQwMCIgZmlsbD0iYmxhY2siIHg9IjIuNDA4IiB5PSIxNSI+dXNlci9iaXJ0aC15ZWFyPC90c3Bhbj4KICAgICAgICA8L3RleHQ+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkxpbmVfNiIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxsaW5lIHgxPSI3NjkiIHkxPSI0NTQuNSIgeDI9Ijk2OC42IiB5Mj0iNDU0LjUiIG1hcmtlci1lbmQ9InVybCgjRmlsbGVkQXJyb3dfTWFya2VyKSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiLz4KICAgICAgPC9nPgogICAgICA8ZyBpZD0iR3JhcGhpY183IiBmaWx0ZXI9InVybCgjU2hhZG93KSI+CiAgICAgICAgPHJlY3QgeD0iODE1Ljg0ODciIHk9IjQ0MC4yNzYiIHdpZHRoPSIxMDQuNTQ0IiBoZWlnaHQ9IjI4LjQ0Nzk5OCIgZmlsbD0iI2MwYzBmZiIvPgogICAgICAgIDx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDgyMC44NDg3IDQ0NS4yNzYpIiBmaWxsPSJibGFjayI+CiAgICAgICAgICA8dHNwYW4gZm9udC1mYW1pbHk9IkhlbHZldGljYSBOZXVlIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iNDAwIiBmaWxsPSJibGFjayIgeD0iODQ1NTQ1OWUtMTkiIHk9IjE1Ij51c2VyLWJpcnRoZGF5PC90c3Bhbj4KICAgICAgICA8L3RleHQ+CiAgICAgIDwvZz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo=" width="523" height="159"></p></div><admonition type="note"><p>I made the names short on the diagrams for space, but keep your domain qualifiers long.</p></admonition><p>This example was a simplification; most systems will store the full birth date instead,
and then extract the year from this date.</p><p>We can simulate such case using the following setup:</p><pre><code class="language-clojure">; define a map for indexed access to user data
(def users-db
  {1 #:acme.user{:name     &quot;Usuario 1&quot;
                 :email    &quot;user@provider.com&quot;
                 :birthday &quot;1989-10-25&quot;}
   2 #:acme.user{:name     &quot;Usuario 2&quot;
                 :email    &quot;anuser@provider.com&quot;
                 :birthday &quot;1975-09-11&quot;}})

; pull stored user info from id
(pco/defresolver user-by-id [{:keys [acme.user/id]}]
  {::pco/output
   [:acme.user/name
    :acme.user/email
    :acme.user/birthday]}
  (get users-db id))

; extract birth year from birthday
(pco/defresolver birth-year [{:keys [acme.user/birthday]}]
  {:acme.user/birth-year (first (str/split birthday #&quot;-&quot;))})
</code></pre><p>Here is a diagram from the previous setup:</p><div class="pathom-diagram"><p>  <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM6eGw9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjM2MCA2MjUgODA1IDU2NiIgd2lkdGg9IjgwNSIgaGVpZ2h0PSI1NjYiPgogIDxkZWZzPgogICAgPGZpbHRlciBpZD0iU2hhZG93IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHg9IjI3OS41IiB5PSI1NjguNCI+CiAgICAgIDxmZUdhdXNzaWFuQmx1ciBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0iYmx1ciIgc3RkRGV2aWF0aW9uPSIxLjMwOCIvPgogICAgICA8ZmVPZmZzZXQgaW49ImJsdXIiIHJlc3VsdD0ib2Zmc2V0IiBkeD0iMSIgZHk9IjMiLz4KICAgICAgPGZlRmxvb2QgZmxvb2QtY29sb3I9ImJsYWNrIiBmbG9vZC1vcGFjaXR5PSIuNSIgcmVzdWx0PSJmbG9vZCIvPgogICAgICA8ZmVDb21wb3NpdGUgaW49ImZsb29kIiBpbjI9Im9mZnNldCIgb3BlcmF0b3I9ImluIiByZXN1bHQ9ImNvbG9yIi8+CiAgICAgIDxmZU1lcmdlPgogICAgICAgIDxmZU1lcmdlTm9kZSBpbj0iY29sb3IiLz4KICAgICAgICA8ZmVNZXJnZU5vZGUgaW49IlNvdXJjZUdyYXBoaWMiLz4KICAgICAgPC9mZU1lcmdlPgogICAgPC9maWx0ZXI+CiAgICA8Zm9udC1mYWNlIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgcGFub3NlLTE9IjIgMCA1IDMgMCAwIDAgMiAwIDQiIHVuaXRzLXBlci1lbT0iMTAwMCIgdW5kZXJsaW5lLXBvc2l0aW9uPSItMTAwIiB1bmRlcmxpbmUtdGhpY2tuZXNzPSI1MCIgc2xvcGU9IjAiIHgtaGVpZ2h0PSI1MTciIGNhcC1oZWlnaHQ9IjcxNCIgYXNjZW50PSI5NTEuOTk1OCIgZGVzY2VudD0iLTIxMi45OTc0NCIgZm9udC13ZWlnaHQ9IjQwMCI+CiAgICAgIDxmb250LWZhY2Utc3JjPgogICAgICAgIDxmb250LWZhY2UtbmFtZSBuYW1lPSJIZWx2ZXRpY2FOZXVlIi8+CiAgICAgIDwvZm9udC1mYWNlLXNyYz4KICAgIDwvZm9udC1mYWNlPgogICAgPG1hcmtlciBvcmllbnQ9ImF1dG8iIG92ZXJmbG93PSJ2aXNpYmxlIiBtYXJrZXJVbml0cz0ic3Ryb2tlV2lkdGgiIGlkPSJGaWxsZWRBcnJvd19NYXJrZXIiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgdmlld0JveD0iLTEgLTMgNyA2IiBtYXJrZXJXaWR0aD0iNyIgbWFya2VySGVpZ2h0PSI2IiBjb2xvcj0id2hpdGUiPgogICAgICA8Zz4KICAgICAgICA8cGF0aCBkPSJNIDQuOCAwIEwgMCAtMS44IEwgMCAxLjggWiIgZmlsbD0iY3VycmVudENvbG9yIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgICAgIDwvZz4KICAgIDwvbWFya2VyPgogIDwvZGVmcz4KICA8bWV0YWRhdGE+IFByb2R1Y2VkIGJ5IE9tbmlHcmFmZmxlIDcuMTcuNVxuMjAyMC0xMC0wNSAyMDo0MzozMyArMDAwMDwvbWV0YWRhdGE+CiAgPGcgaWQ9IkNhbnZhc18yIiBmaWxsPSJub25lIiBzdHJva2Utb3BhY2l0eT0iMSIgZmlsbC1vcGFjaXR5PSIxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS1kYXNoYXJyYXk9Im5vbmUiPgogICAgPHRpdGxlPkNhbnZhcyAyPC90aXRsZT4KICAgIDxnIGlkPSJDYW52YXNfMl9MYXllcl8xIj4KICAgICAgPHRpdGxlPkxheWVyIDE8L3RpdGxlPgogICAgICA8ZyBpZD0iR3JhcGhpY18xNCIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxjaXJjbGUgY3g9Ijc0MiIgY3k9IjExMDkiIHI9Ijc1LjAwMDExOTg0MjY0MjIiIGZpbGw9IiNmZmZmYzAiLz4KICAgICAgICA8Y2lyY2xlIGN4PSI3NDIiIGN5PSIxMTA5IiByPSI3NS4wMDAxMTk4NDI2NDIyIiBzdHJva2U9IiNmMGYzZjYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICAgICAgPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjg3IDEwOTkuNzc2KSIgZmlsbD0iYmxhY2siPgogICAgICAgICAgPHRzcGFuIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjQwMCIgZmlsbD0iYmxhY2siIHg9IjcuNzM2IiB5PSIxNSI+dXNlci9iaXJ0aGRheTwvdHNwYW4+CiAgICAgICAgPC90ZXh0PgogICAgICA8L2c+CiAgICAgIDxnIGlkPSJHcmFwaGljXzEzIiBmaWx0ZXI9InVybCgjU2hhZG93KSI+CiAgICAgICAgPGNpcmNsZSBjeD0iMTA4NC41IiBjeT0iMTEwOSIgcj0iNzUuMDAwMTE5ODQyNjQyMSIgZmlsbD0iI2ZmZmZjMCIvPgogICAgICAgIDxjaXJjbGUgY3g9IjEwODQuNSIgY3k9IjExMDkiIHI9Ijc1LjAwMDExOTg0MjY0MjEiIHN0cm9rZT0iI2YwZjNmNiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiLz4KICAgICAgICA8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMDI5LjUgMTA5OS43NzYpIiBmaWxsPSJibGFjayI+CiAgICAgICAgICA8dHNwYW4gZm9udC1mYW1pbHk9IkhlbHZldGljYSBOZXVlIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iNDAwIiBmaWxsPSJibGFjayIgeD0iMi40MDgiIHk9IjE1Ij51c2VyL2JpcnRoLXllYXI8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgICA8ZyBpZD0iTGluZV8xMiIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxsaW5lIHgxPSI4MTgiIHkxPSIxMTA5IiB4Mj0iOTk1LjYiIHkyPSIxMTA5IiBtYXJrZXItZW5kPSJ1cmwoI0ZpbGxlZEFycm93X01hcmtlcikiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkdyYXBoaWNfMTEiIGZpbHRlcj0idXJsKCNTaGFkb3cpIj4KICAgICAgICA8cmVjdCB4PSI4NTQuMjk4OCIgeT0iMTA5NC43NzYiIHdpZHRoPSIxMDUuMTIiIGhlaWdodD0iMjguNDQ3OTk4IiBmaWxsPSIjYzBjMGZmIi8+CiAgICAgICAgPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODU5LjI5ODggMTA5OS43NzYpIiBmaWxsPSJibGFjayI+CiAgICAgICAgICA8dHNwYW4gZm9udC1mYW1pbHk9IkhlbHZldGljYSBOZXVlIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iNDAwIiBmaWxsPSJibGFjayIgeD0iMCIgeT0iMTUiPmJpcnRoZGF5LXllYXI8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgICA8ZyBpZD0iR3JhcGhpY18xMCIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxjaXJjbGUgY3g9IjQzOC41IiBjeT0iOTA1IiByPSI3NS4wMDAxMTk4NDI2NDIyIiBmaWxsPSIjZmZmZmMwIi8+CiAgICAgICAgPGNpcmNsZSBjeD0iNDM4LjUiIGN5PSI5MDUiIHI9Ijc1LjAwMDExOTg0MjY0MjIiIHN0cm9rZT0iI2YwZjNmNiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiLz4KICAgICAgICA8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzODMuNSA4OTUuNzc2KSIgZmlsbD0iYmxhY2siPgogICAgICAgICAgPHRzcGFuIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjQwMCIgZmlsbD0iYmxhY2siIHg9IjMwLjQwOCIgeT0iMTUiPnVzZXIvaWQ8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgICA8ZyBpZD0iTGluZV85IiBmaWx0ZXI9InVybCgjU2hhZG93KSI+CiAgICAgICAgPGxpbmUgeDE9IjUwMS41ODczNCIgeTE9Ijk0Ny40MDQ3IiB4Mj0iNjY4LjIwNjQiIHkyPSIxMDU5LjM5OSIgbWFya2VyLWVuZD0idXJsKCNGaWxsZWRBcnJvd19NYXJrZXIpIiBzdHJva2U9IndoaXRlIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICA8L2c+CiAgICAgIDxnIGlkPSJHcmFwaGljXzgiIGZpbHRlcj0idXJsKCNTaGFkb3cpIj4KICAgICAgICA8cmVjdCB4PSI1NDIuODQ0OCIgeT0iOTg4Ljc3NzIiIHdpZHRoPSI4Mi45MTIiIGhlaWdodD0iMjguNDQ3OTk4IiBmaWxsPSIjYzBjMGZmIi8+CiAgICAgICAgPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTQ3Ljg0NDggOTkzLjc3NzIpIiBmaWxsPSJibGFjayI+CiAgICAgICAgICA8dHNwYW4gZm9udC1mYW1pbHk9IkhlbHZldGljYSBOZXVlIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iNDAwIiBmaWxsPSJibGFjayIgeD0iMTI3ODk3N2UtMTkiIHk9IjE1Ij51c2VyLWJ5LWlkPC90c3Bhbj4KICAgICAgICA8L3RleHQ+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkdyYXBoaWNfNyIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxjaXJjbGUgY3g9Ijc0MiIgY3k9IjcwMSIgcj0iNzUuMDAwMTE5ODQyNjQyMiIgZmlsbD0iI2ZmZmZjMCIvPgogICAgICAgIDxjaXJjbGUgY3g9Ijc0MiIgY3k9IjcwMSIgcj0iNzUuMDAwMTE5ODQyNjQyMiIgc3Ryb2tlPSIjZjBmM2Y2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICAgIDx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY4NyA2OTEuNzc2KSIgZmlsbD0iYmxhY2siPgogICAgICAgICAgPHRzcGFuIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjQwMCIgZmlsbD0iYmxhY2siIHg9IjE3LjA2NCIgeT0iMTUiPnVzZXIvbmFtZTwvdHNwYW4+CiAgICAgICAgPC90ZXh0PgogICAgICA8L2c+CiAgICAgIDxnIGlkPSJHcmFwaGljXzYiIGZpbHRlcj0idXJsKCNTaGFkb3cpIj4KICAgICAgICA8Y2lyY2xlIGN4PSI3NDIiIGN5PSI5MDUiIHI9Ijc1LjAwMDExOTg0MjY0MjIiIGZpbGw9IiNmZmZmYzAiLz4KICAgICAgICA8Y2lyY2xlIGN4PSI3NDIiIGN5PSI5MDUiIHI9Ijc1LjAwMDExOTg0MjY0MjIiIHN0cm9rZT0iI2YwZjNmNiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiLz4KICAgICAgICA8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2ODcgODk1Ljc3NikiIGZpbGw9ImJsYWNrIj4KICAgICAgICAgIDx0c3BhbiBmb250LWZhbWlseT0iSGVsdmV0aWNhIE5ldWUiIGZvbnQtc2l6ZT0iMTYiIGZvbnQtd2VpZ2h0PSI0MDAiIGZpbGw9ImJsYWNrIiB4PSIxNy45NiIgeT0iMTUiPnVzZXIvZW1haWw8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgICA8ZyBpZD0iTGluZV81IiBmaWx0ZXI9InVybCgjU2hhZG93KSI+CiAgICAgICAgPGxpbmUgeDE9IjUxNC41MDAwNCIgeTE9IjkwNSIgeDI9IjY1My4xIiB5Mj0iOTA1IiBtYXJrZXItZW5kPSJ1cmwoI0ZpbGxlZEFycm93X01hcmtlcikiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkdyYXBoaWNfNCIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxyZWN0IHg9IjU0My43MTEyIiB5PSI4OTAuNzc2IiB3aWR0aD0iODIuOTEyIiBoZWlnaHQ9IjI4LjQ0Nzk5OCIgZmlsbD0iI2MwYzBmZiIvPgogICAgICAgIDx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDU0OC43MTEyIDg5NS43NzYpIiBmaWxsPSJibGFjayI+CiAgICAgICAgICA8dHNwYW4gZm9udC1mYW1pbHk9IkhlbHZldGljYSBOZXVlIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iNDAwIiBmaWxsPSJibGFjayIgeD0iMTI3ODk3N2UtMTkiIHk9IjE1Ij51c2VyLWJ5LWlkPC90c3Bhbj4KICAgICAgICA8L3RleHQ+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkxpbmVfMyIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxsaW5lIHgxPSI1MDEuNTg3MzMiIHkxPSI4NjIuNTk1MyIgeDI9IjY2OC4yMDY0IiB5Mj0iNzUwLjYwMDk1IiBtYXJrZXItZW5kPSJ1cmwoI0ZpbGxlZEFycm93X01hcmtlcikiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkdyYXBoaWNfMiIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxyZWN0IHg9IjU0Mi44NDQ4IiB5PSI3OTIuNzc0OCIgd2lkdGg9IjgyLjkxMiIgaGVpZ2h0PSIyOC40NDc5OTgiIGZpbGw9IiNjMGMwZmYiLz4KICAgICAgICA8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NDcuODQ0OCA3OTcuNzc0OCkiIGZpbGw9ImJsYWNrIj4KICAgICAgICAgIDx0c3BhbiBmb250LWZhbWlseT0iSGVsdmV0aWNhIE5ldWUiIGZvbnQtc2l6ZT0iMTYiIGZvbnQtd2VpZ2h0PSI0MDAiIGZpbGw9ImJsYWNrIiB4PSIxMjc4OTc3ZS0xOSIgeT0iMTUiPnVzZXItYnktaWQ8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgPC9nPgogIDwvZz4KPC9zdmc+Cg==" width="805" height="566"></p></div><p>Given that image, let&#x27;s consider that we know about some user id and want to know
this user birthday, we can reach that using the path highlighted in the next diagram:</p><div class="pathom-diagram"><p>  <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM6eGw9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjM2MCA2MjUgODA1IDU2NiIgd2lkdGg9IjgwNSIgaGVpZ2h0PSI1NjYiPgogIDxkZWZzPgogICAgPGZpbHRlciBpZD0iU2hhZG93IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHg9IjI3OS41IiB5PSI1NjguNCI+CiAgICAgIDxmZUdhdXNzaWFuQmx1ciBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0iYmx1ciIgc3RkRGV2aWF0aW9uPSIxLjMwOCIvPgogICAgICA8ZmVPZmZzZXQgaW49ImJsdXIiIHJlc3VsdD0ib2Zmc2V0IiBkeD0iMSIgZHk9IjMiLz4KICAgICAgPGZlRmxvb2QgZmxvb2QtY29sb3I9ImJsYWNrIiBmbG9vZC1vcGFjaXR5PSIuNSIgcmVzdWx0PSJmbG9vZCIvPgogICAgICA8ZmVDb21wb3NpdGUgaW49ImZsb29kIiBpbjI9Im9mZnNldCIgb3BlcmF0b3I9ImluIiByZXN1bHQ9ImNvbG9yIi8+CiAgICAgIDxmZU1lcmdlPgogICAgICAgIDxmZU1lcmdlTm9kZSBpbj0iY29sb3IiLz4KICAgICAgICA8ZmVNZXJnZU5vZGUgaW49IlNvdXJjZUdyYXBoaWMiLz4KICAgICAgPC9mZU1lcmdlPgogICAgPC9maWx0ZXI+CiAgICA8Zm9udC1mYWNlIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgcGFub3NlLTE9IjIgMCA1IDMgMCAwIDAgMiAwIDQiIHVuaXRzLXBlci1lbT0iMTAwMCIgdW5kZXJsaW5lLXBvc2l0aW9uPSItMTAwIiB1bmRlcmxpbmUtdGhpY2tuZXNzPSI1MCIgc2xvcGU9IjAiIHgtaGVpZ2h0PSI1MTciIGNhcC1oZWlnaHQ9IjcxNCIgYXNjZW50PSI5NTEuOTk1OCIgZGVzY2VudD0iLTIxMi45OTc0NCIgZm9udC13ZWlnaHQ9IjQwMCI+CiAgICAgIDxmb250LWZhY2Utc3JjPgogICAgICAgIDxmb250LWZhY2UtbmFtZSBuYW1lPSJIZWx2ZXRpY2FOZXVlIi8+CiAgICAgIDwvZm9udC1mYWNlLXNyYz4KICAgIDwvZm9udC1mYWNlPgogICAgPG1hcmtlciBvcmllbnQ9ImF1dG8iIG92ZXJmbG93PSJ2aXNpYmxlIiBtYXJrZXJVbml0cz0ic3Ryb2tlV2lkdGgiIGlkPSJGaWxsZWRBcnJvd19NYXJrZXIiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgdmlld0JveD0iLTEgLTMgNSA2IiBtYXJrZXJXaWR0aD0iNSIgbWFya2VySGVpZ2h0PSI2IiBjb2xvcj0ibGltZSI+CiAgICAgIDxnPgogICAgICAgIDxwYXRoIGQ9Ik0gMi44OCAwIEwgMCAtMS4wOCBMIDAgMS4wOCBaIiBmaWxsPSJjdXJyZW50Q29sb3IiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjEiLz4KICAgICAgPC9nPgogICAgPC9tYXJrZXI+CiAgICA8bWFya2VyIG9yaWVudD0iYXV0byIgb3ZlcmZsb3c9InZpc2libGUiIG1hcmtlclVuaXRzPSJzdHJva2VXaWR0aCIgaWQ9IkZpbGxlZEFycm93X01hcmtlcl8yIiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHZpZXdCb3g9Ii0xIC0zIDcgNiIgbWFya2VyV2lkdGg9IjciIG1hcmtlckhlaWdodD0iNiIgY29sb3I9IndoaXRlIj4KICAgICAgPGc+CiAgICAgICAgPHBhdGggZD0iTSA0LjggMCBMIDAgLTEuOCBMIDAgMS44IFoiIGZpbGw9ImN1cnJlbnRDb2xvciIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgICA8L2c+CiAgICA8L21hcmtlcj4KICA8L2RlZnM+CiAgPG1ldGFkYXRhPiBQcm9kdWNlZCBieSBPbW5pR3JhZmZsZSA3LjE3LjVcbjIwMjAtMTAtMDcgMjE6MDU6MzYgKzAwMDA8L21ldGFkYXRhPgogIDxnIGlkPSJDYW52YXNfMiIgZmlsbD0ibm9uZSIgc3Ryb2tlLW9wYWNpdHk9IjEiIGZpbGwtb3BhY2l0eT0iMSIgc3Ryb2tlPSJub25lIiBzdHJva2UtZGFzaGFycmF5PSJub25lIj4KICAgIDx0aXRsZT5DYW52YXMgMjwvdGl0bGU+CiAgICA8ZyBpZD0iQ2FudmFzXzJfTGF5ZXJfMSI+CiAgICAgIDx0aXRsZT5MYXllciAxPC90aXRsZT4KICAgICAgPGcgaWQ9IkdyYXBoaWNfMTQiIGZpbHRlcj0idXJsKCNTaGFkb3cpIj4KICAgICAgICA8Y2lyY2xlIGN4PSI3NDIiIGN5PSIxMTA5IiByPSI3NS4wMDAxMTk4NDI2NDIyIiBmaWxsPSIjZmZmZmMwIi8+CiAgICAgICAgPGNpcmNsZSBjeD0iNzQyIiBjeT0iMTEwOSIgcj0iNzUuMDAwMTE5ODQyNjQyMiIgc3Ryb2tlPSIjZjBmM2Y2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICAgIDx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY4NyAxMDk5Ljc3NikiIGZpbGw9ImJsYWNrIj4KICAgICAgICAgIDx0c3BhbiBmb250LWZhbWlseT0iSGVsdmV0aWNhIE5ldWUiIGZvbnQtc2l6ZT0iMTYiIGZvbnQtd2VpZ2h0PSI0MDAiIGZpbGw9ImJsYWNrIiB4PSI3LjczNiIgeT0iMTUiPnVzZXIvYmlydGhkYXk8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgICA8ZyBpZD0iR3JhcGhpY18xMyIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxjaXJjbGUgY3g9IjEwODQuNSIgY3k9IjExMDkiIHI9Ijc1LjAwMDExOTg0MjY0MjEiIGZpbGw9IiNmZmZmYzAiLz4KICAgICAgICA8Y2lyY2xlIGN4PSIxMDg0LjUiIGN5PSIxMTA5IiByPSI3NS4wMDAxMTk4NDI2NDIxIiBzdHJva2U9IiNmMGYzZjYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICAgICAgPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAyOS41IDEwOTkuNzc2KSIgZmlsbD0iYmxhY2siPgogICAgICAgICAgPHRzcGFuIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjQwMCIgZmlsbD0iYmxhY2siIHg9IjIuNDA4IiB5PSIxNSI+dXNlci9iaXJ0aC15ZWFyPC90c3Bhbj4KICAgICAgICA8L3RleHQ+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkxpbmVfMTIiIGZpbHRlcj0idXJsKCNTaGFkb3cpIj4KICAgICAgICA8bGluZSB4MT0iODE4IiB5MT0iMTEwOSIgeDI9Ijk4Ni42IiB5Mj0iMTEwOSIgbWFya2VyLWVuZD0idXJsKCNGaWxsZWRBcnJvd19NYXJrZXIpIiBzdHJva2U9ImxpbWUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1Ii8+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkdyYXBoaWNfMTEiIGZpbHRlcj0idXJsKCNTaGFkb3cpIj4KICAgICAgICA8cmVjdCB4PSI4NTQuMjk4OCIgeT0iMTA5NC43NzYiIHdpZHRoPSIxMDUuMTIiIGhlaWdodD0iMjguNDQ3OTk4IiBmaWxsPSIjYzBjMGZmIi8+CiAgICAgICAgPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODU5LjI5ODggMTA5OS43NzYpIiBmaWxsPSJibGFjayI+CiAgICAgICAgICA8dHNwYW4gZm9udC1mYW1pbHk9IkhlbHZldGljYSBOZXVlIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iNDAwIiBmaWxsPSJibGFjayIgeD0iMCIgeT0iMTUiPmJpcnRoZGF5LXllYXI8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgICA8ZyBpZD0iR3JhcGhpY18xMCIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxjaXJjbGUgY3g9IjQzOC41IiBjeT0iOTA1IiByPSI3NS4wMDAxMTk4NDI2NDIyIiBmaWxsPSIjZmZmZmMwIi8+CiAgICAgICAgPGNpcmNsZSBjeD0iNDM4LjUiIGN5PSI5MDUiIHI9Ijc1LjAwMDExOTg0MjY0MjIiIHN0cm9rZT0iI2YwZjNmNiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiLz4KICAgICAgICA8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzODMuNSA4OTUuNzc2KSIgZmlsbD0iYmxhY2siPgogICAgICAgICAgPHRzcGFuIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjQwMCIgZmlsbD0iYmxhY2siIHg9IjMwLjQwOCIgeT0iMTUiPnVzZXIvaWQ8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgICA8ZyBpZD0iTGluZV85IiBmaWx0ZXI9InVybCgjU2hhZG93KSI+CiAgICAgICAgPGxpbmUgeDE9IjUwMS41ODczNCIgeTE9Ijk0Ny40MDQ3IiB4Mj0iNjYwLjczNyIgeTI9IjEwNTQuMzc4NCIgbWFya2VyLWVuZD0idXJsKCNGaWxsZWRBcnJvd19NYXJrZXIpIiBzdHJva2U9ImxpbWUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1Ii8+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkdyYXBoaWNfOCIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxyZWN0IHg9IjU0Mi44NDQ4IiB5PSI5ODguNzc3MiIgd2lkdGg9IjgyLjkxMiIgaGVpZ2h0PSIyOC40NDc5OTgiIGZpbGw9IiNjMGMwZmYiLz4KICAgICAgICA8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NDcuODQ0OCA5OTMuNzc3MikiIGZpbGw9ImJsYWNrIj4KICAgICAgICAgIDx0c3BhbiBmb250LWZhbWlseT0iSGVsdmV0aWNhIE5ldWUiIGZvbnQtc2l6ZT0iMTYiIGZvbnQtd2VpZ2h0PSI0MDAiIGZpbGw9ImJsYWNrIiB4PSIxMjc4OTc3ZS0xOSIgeT0iMTUiPnVzZXItYnktaWQ8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgICA8ZyBpZD0iR3JhcGhpY183IiBmaWx0ZXI9InVybCgjU2hhZG93KSI+CiAgICAgICAgPGNpcmNsZSBjeD0iNzQyIiBjeT0iNzAxIiByPSI3NS4wMDAxMTk4NDI2NDIyIiBmaWxsPSIjZmZmZmMwIi8+CiAgICAgICAgPGNpcmNsZSBjeD0iNzQyIiBjeT0iNzAxIiByPSI3NS4wMDAxMTk4NDI2NDIyIiBzdHJva2U9IiNmMGYzZjYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICAgICAgPHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjg3IDY5MS43NzYpIiBmaWxsPSJibGFjayI+CiAgICAgICAgICA8dHNwYW4gZm9udC1mYW1pbHk9IkhlbHZldGljYSBOZXVlIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iNDAwIiBmaWxsPSJibGFjayIgeD0iMTcuMDY0IiB5PSIxNSI+dXNlci9uYW1lPC90c3Bhbj4KICAgICAgICA8L3RleHQ+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkdyYXBoaWNfNiIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxjaXJjbGUgY3g9Ijc0MiIgY3k9IjkwNSIgcj0iNzUuMDAwMTE5ODQyNjQyMiIgZmlsbD0iI2ZmZmZjMCIvPgogICAgICAgIDxjaXJjbGUgY3g9Ijc0MiIgY3k9IjkwNSIgcj0iNzUuMDAwMTE5ODQyNjQyMiIgc3Ryb2tlPSIjZjBmM2Y2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICAgIDx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY4NyA4OTUuNzc2KSIgZmlsbD0iYmxhY2siPgogICAgICAgICAgPHRzcGFuIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjQwMCIgZmlsbD0iYmxhY2siIHg9IjE3Ljk2IiB5PSIxNSI+dXNlci9lbWFpbDwvdHNwYW4+CiAgICAgICAgPC90ZXh0PgogICAgICA8L2c+CiAgICAgIDxnIGlkPSJMaW5lXzUiIGZpbHRlcj0idXJsKCNTaGFkb3cpIj4KICAgICAgICA8bGluZSB4MT0iNTE0LjUwMDA0IiB5MT0iOTA1IiB4Mj0iNjUzLjEiIHkyPSI5MDUiIG1hcmtlci1lbmQ9InVybCgjRmlsbGVkQXJyb3dfTWFya2VyXzIpIiBzdHJva2U9IndoaXRlIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICA8L2c+CiAgICAgIDxnIGlkPSJHcmFwaGljXzQiIGZpbHRlcj0idXJsKCNTaGFkb3cpIj4KICAgICAgICA8cmVjdCB4PSI1NDMuNzExMiIgeT0iODkwLjc3NiIgd2lkdGg9IjgyLjkxMiIgaGVpZ2h0PSIyOC40NDc5OTgiIGZpbGw9IiNjMGMwZmYiLz4KICAgICAgICA8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NDguNzExMiA4OTUuNzc2KSIgZmlsbD0iYmxhY2siPgogICAgICAgICAgPHRzcGFuIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EgTmV1ZSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjQwMCIgZmlsbD0iYmxhY2siIHg9IjEyNzg5NzdlLTE5IiB5PSIxNSI+dXNlci1ieS1pZDwvdHNwYW4+CiAgICAgICAgPC90ZXh0PgogICAgICA8L2c+CiAgICAgIDxnIGlkPSJMaW5lXzMiIGZpbHRlcj0idXJsKCNTaGFkb3cpIj4KICAgICAgICA8bGluZSB4MT0iNTAxLjU4NzMzIiB5MT0iODYyLjU5NTMiIHgyPSI2NjguMjA2NCIgeTI9Ijc1MC42MDA5NSIgbWFya2VyLWVuZD0idXJsKCNGaWxsZWRBcnJvd19NYXJrZXJfMikiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICAgIDwvZz4KICAgICAgPGcgaWQ9IkdyYXBoaWNfMiIgZmlsdGVyPSJ1cmwoI1NoYWRvdykiPgogICAgICAgIDxyZWN0IHg9IjU0Mi44NDQ4IiB5PSI3OTIuNzc0OCIgd2lkdGg9IjgyLjkxMiIgaGVpZ2h0PSIyOC40NDc5OTgiIGZpbGw9IiNjMGMwZmYiLz4KICAgICAgICA8dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NDcuODQ0OCA3OTcuNzc0OCkiIGZpbGw9ImJsYWNrIj4KICAgICAgICAgIDx0c3BhbiBmb250LWZhbWlseT0iSGVsdmV0aWNhIE5ldWUiIGZvbnQtc2l6ZT0iMTYiIGZvbnQtd2VpZ2h0PSI0MDAiIGZpbGw9ImJsYWNrIiB4PSIxMjc4OTc3ZS0xOSIgeT0iMTUiPnVzZXItYnktaWQ8L3RzcGFuPgogICAgICAgIDwvdGV4dD4KICAgICAgPC9nPgogICAgPC9nPgogIDwvZz4KPC9zdmc+Cg==" width="805" height="566"></p></div><p>Here I&#x27;ll show you one way of doing a request like this, using the Pathom EQL interface:</p><pre><code class="language-clojure">; process needs an environment configuration
(p.eql/process env
  ; we can provide some initial data
  {:acme.user/id 1}
  ; then we write an EQL query
  [:acme.user/birth-year])
; =&gt; {:acme.user/birth-year &quot;1989&quot;}
</code></pre><p>So resolvers establish edges in the Pathom graph, allowing Pathom to traverse from
some source data to some target data. In the rest of this documentation, you will learn
how to define resolvers.</p><h2 id="using-defresolver">Using <code>defresolver</code></h2><p>The macro <code>defresolver</code> is the primary way to create new resolvers. It has some sugars
to reduce the boilerplate code related to define a new resolver.</p><p>The main pieces of a resolver are:</p><ul><li><code>::pco/op-name</code> - a symbol that identify the resolver, like a function name.</li><li><code>::pco/output</code> - a EQL expression that informs the attributes <strong>provided</strong> by this resolver.</li><li><code>::pco/input</code> - a EQL expression that informs the attributes <strong>required</strong> by this resolver.</li></ul><admonition type="important"><p>Both input and output can express flat or nested queries, you should always strive to
be as precise with these descriptions as you can (matching the shapes of your inputs and
outputs), Pathom leverages this information in many ways during transaction processing,
and as more accurate you get, the more Pathom can do with it.</p></admonition><p>Let&#x27;s start with a verbose usage of <code>defresolver</code> to go over these main pieces:</p><pre><code class="language-clojure">; this resolver computes a slug to use on URL from some article title
(pco/defresolver article-slug [env {:acme.article/keys [title]}]
  {::pco/op-name `article-slug
   ::pco/input   [:acme.article/title]
   ::pco/output  [:acme.article/slug]}
  {:acme.article/slug (str/replace title #&quot;[^a-z0-9A-Z]&quot; &quot;-&quot;)})
</code></pre><admonition title="Design observation" type="note"><p>This resolver expresses an edge in Pathom attribute world. It says the attribute <code>:acme.article/slug</code>
is reachable, given that a <code>:acme.article/title</code> is available.</p></admonition><p>If you look close, you can find a fair amount of repetition in this expression:</p><ul><li>The <code>op-name</code> is repeated at the start to define the <code>var</code> name.</li><li>The <code>input</code> is repeated in the destructuring expression.</li><li>The <code>output</code> is visible in the output expression.</li></ul><p>Experience with Pathom 2 demonstrated these repetitions occur frequently in most Pathom
code bases. So Pathom 3 adds some extra sugar tricks to avoid the repetition:</p><ol><li>We can remove the <code>::pco/op-name</code> and let <code>defresolver</code> use the same symbol as the <code>var</code>:</li></ol><pre><code class="language-clojure">(pco/defresolver article-slug [env {:acme.article/keys [title]}]
  {::pco/input  [:acme.article/title]
   ::pco/output [:acme.article/slug]}
  {:acme.article/slug (str/replace title #&quot;[^a-z0-9A-Z]&quot; &quot;-&quot;)})
</code></pre><admonition type="tip"><p>If you use <a href="https://cursive-ide.com/">Cursive</a>, you can ask it to resolve the
<code>pco/defresolver</code> as a <code>defn</code>, and you will get proper symbol resolution</p></admonition><ol start="2"><li>Now, given the <code>input</code> is the same as destructuring, we can let <code>defresolver</code> infer the input from it:</li></ol><pre><code class="language-clojure">(pco/defresolver article-slug [env {:acme.article/keys [title]}]
  {::pco/output [:acme.article/slug]}
  {:acme.article/slug (str/replace title #&quot;[^a-z0-9A-Z]&quot; &quot;-&quot;)})
</code></pre><admonition type="note"><p>You can also use destructuring via symbol binding, for example, this works the same:</p><pre><code class="language-clojure">(pco/defresolver article-slug [env {title :acme.article/title}]
  {::pco/output [:acme.article/slug]}
  {:acme.article/slug (str/replace title #&quot;[^a-z0-9A-Z]&quot; &quot;-&quot;)})
</code></pre></admonition><ol start="3"><li>Since the last element of our expression is a map, <code>defresolver</code> can infer the <code>output</code> from it:</li></ol><pre><code class="language-clojure">; given the map would be empty now, we can remove it completely
(pco/defresolver article-slug [env {:acme.article/keys [title]}]
  {:acme.article/slug (str/replace title #&quot;[^a-z0-9A-Z]&quot; &quot;-&quot;)})
</code></pre><admonition type="important"><p>Pathom only looks at the last item of the body for implicit outputs. This means that
if you wrap the map with something like a <code>let</code> statement, Pathom will not be able
to figure it out. Instead, you can move the <code>let</code> down on the attribute level:</p><pre><code class="language-clojure">(pco/defresolver foo []
  ; infer won&#x27;t work, the last statement is a let
  (let [x 10]
    {:foo x}))

(pco/defresolver foo []
  ; works
  {:foo (let [x 10] x)})
</code></pre><p>In the future, Pathom may get smarter around this, but this is a long rabbit role when
I consider that the last user statement may be an <code>if</code>, <code>cond</code>, etc...</p></admonition><admonition type="note"><p>Although Pathom can infer the configuration, you can always override it using the
options map. In case of inputs and params, your explicit definitions will be merged
with the inferred ones from Pathom, giving precedence to the explicit definition in
case of conflicts.</p></admonition><ol start="4"><li>Given we are not using <code>env</code>, we can also take it out, taking us to the final version:</li></ol><pre><code class="language-clojure">(pco/defresolver article-slug [{:acme.article/keys [title]}]
  {:acme.article/slug (str/replace title #&quot;[^a-z0-9A-Z]&quot; &quot;-&quot;)})
</code></pre><admonition type="tip"><p>In case you have a resolver that doesn&#x27;t use an input, you can omit the first argument
as well, for example:</p><pre><code class="language-clojure">(pco/defresolver constant-pi []
  {:acme.math/pi 3.1415})
</code></pre></admonition><h2 id="invoking-resolvers">Invoking resolvers</h2><p>Like functions, you can call the resolvers directly:</p><pre><code class="language-clojure">(pco/defresolver extension [{::keys [path]}]
  {::path-ext (last (str/split path #&quot;\.&quot;))})

(extension {::path &quot;foo.txt&quot;})
; =&gt; {::path-ext &quot;txt&quot;}
</code></pre><p>This makes it easier to test resolvers in unit tests.</p><p>A direct call uses the arity of the resolver. In this example, the resolver takes a single parameter
representing a map containing the key <code>::path</code>.</p><p>Outside of the test context, you should have little reason to invoke a resolver directly. What
sets resolvers apart from regular functions are that it contains data about its requirements
and what it provides.</p><p>This allows you to abstract away the operation names and focus only on the attributes.</p><p>To illustrate the difference, let&#x27;s compare the two approaches, first let&#x27;s define the resolvers:</p><pre><code class="language-clojure">(ns com.wsscode.pathom.docs.resolvers-demos
  (:require [clojure.string :as str]
            [com.wsscode.pathom3.connect.built-in.resolvers :as pbir]
            [com.wsscode.pathom3.connect.indexes :as pci]
            [com.wsscode.pathom3.connect.operation :as pco]
            [com.wsscode.pathom3.interface.smart-map :as psm]))

(def user-from-id
  (pbir/static-table-resolver `user-db :acme.user/id
    {1 #:acme.user{:name  &quot;Trey Parker&quot;
                   :email &quot;trey@provider.com&quot;}
     2 #:acme.user{:name  &quot;Matt Stone&quot;
                   :email &quot;matt@provider.com&quot;}}))

; avatar slug is a version of email, converting every non letter character into dashes
(pco/defresolver user-avatar-slug [{:acme.user/keys [email]}]
  {:acme.user/avatar-slug (str/replace email #&quot;[^a-z0-9A-Z]&quot; &quot;-&quot;)})

(pco/defresolver user-avatar-url [{:acme.user/keys [avatar-slug]}]
  {:acme.user/avatar-url (str &quot;http://avatar-images-host/for-id/&quot; avatar-slug)})
</code></pre><p>Consider the question: What is the <code>avatar url</code> of the user with id <code>1</code>?</p><p>The traditional way to get there using our resolvers as functions goes as:</p><pre><code class="language-clojure">(-&gt; {:acme.user/id 1}
    (user-from-id)
    (user-avatar-slug)
    (user-avatar-url)
    :acme.user/avatar-url)
; =&gt; &quot;http://avatar-images-host/for-id/trey-provider-com&quot;
</code></pre><p>Now check a few examples of how we can accomplish the same using the a <a href="/docs/smart-maps">smart map</a>
leveraged by the resolvers meta-data:</p><pre><code class="language-clojure">; first, we build an index for the relations expressed by the resolvers
(def indexes
  (pci/register [user-from-id
                 user-avatar-slug
                 user-avatar-url]))

; now instead of reference the functions, we let Pathom figure them out using the indexes
(-&gt;&gt; {:acme.user/id 2}
     (psm/smart-map indexes)
     :acme.user/avatar-url)
; =&gt; &quot;http://avatar-images-host/for-id/matt-provider-com&quot;

; to highlight the fact that we disregard the function, other ways where we can change
; the initial data and reach the same result:
(-&gt;&gt; {:acme.user/email &quot;other@provider.com&quot;}
     (psm/smart-map indexes)
     :acme.user/avatar-url)
; =&gt; &quot;http://avatar-images-host/for-id/other-provider-com&quot;

(-&gt;&gt; {:acme.user/avatar-slug &quot;some-slogan&quot;}
     (psm/smart-map indexes)
     :acme.user/avatar-url)
; =&gt; &quot;http://avatar-images-host/for-id/some-slogan&quot;
</code></pre><p>Note how as we change the input, Pathom uses different resolvers to satisfy the request for data.
In this way, Pathom allow you to request the data you need, in a declarative fashion, rather than
making procedural calls. <strong>It removes the chore of knowing the
function names</strong>, so you can focus on the data you have and need, instead of how to
get it.</p><h3 id="using-the-indexes">Using the indexes</h3><p>Here we will cover in more detail the process to generate the indexes from resolvers.</p><p>Think of resolvers as the <strong>atomic blocks of Pathom</strong>, which are annotated functions. If Pathom had to scan
every resolver to figure a path, it would be slow. So instead, Pathom works on indexes
generated from a set of resolvers.</p><p>To generate the indexes, we use the function <code>(pci/register ...)</code>. The values allowed
on <code>register</code> are:</p><ul><li>resolvers</li><li>mutations</li><li>indexes</li><li>sequence of previous items (recursively)</li></ul><p>Here are a couple of examples to illustrate:</p><pre><code class="language-clojure">; create indexes for a single resolver
(def single-registry (pci/register some-resolver))

; creating indexes with a few resolvers
(def many-registry (pci/register [resolver-a resolver-b]))

; define a group of resolvers in a variable
(def some-resolvers [res-a res-b])

; now use in combination with other mixes:
(def more-registry
  (pci/register [some-resolvers
                 [other-group with-more
                  [deep-nested resolvers]]
                 and-more]))

; now using indexes as part of registry
(def with-indexes (pci/register [some-resolvers many-registry]))

; all together now
(def env
  (pci/register [[resolver-a resolver-b]
                 some-resolvers
                 many-registry]))
</code></pre><p>To learn more details about the indexes, check the <a href="/docs/indexes">indexes page</a>.</p><p>With the <code>indexes</code> at hand you can leverage the Pathom engine to call the resolvers for you.</p><admonition type="tip"><p>The <code>indexes</code> are part of the Pathom environment, for some operations just the indexes
are enough. When you see <code>indexes</code> or <code>env</code>, consider they expect to have at least
the indexes for the resolvers in the map.</p></admonition><p>For this you may use one of the Pathom 3 interfaces like <a href="/docs/smart-maps">Smart Maps</a> or
<a href="/docs/eql">EQL</a>. Visit those pages if you like to see examples of how to use the Pathom
engine.</p><h2 id="optional-inputs">Optional inputs</h2><p>You can declare to Pathom that a resolver input is optional. To do so, you can use the
helper <code>pco/?</code> around the attribute.</p><admonition type="note"><p>In practice, this helper adds an EQL param to the keyword, marking it as optional.</p></admonition><p>For this example you can see a resolver that tells how to call the user (for some gretting
message on a site for example). We call this attribute <code>:user/display-name</code>. All users
have emails, but not all users have their names in our database, so to create the
resolver for <code>:user/display-name</code> we make the <code>:user/name</code> attribute optional:</p><pre><code class="language-clojure">(pco/defresolver user-display-name
  [{:user/keys [email name]}]
  {::pco/input [:user/email (pco/? :user/name)]}
  {:user/display-name (or name email)})

(def opt-env
  (pci/register
    [(pbir/static-table-resolver :user/id
       {1 {:user/email &quot;user@example.com&quot;}
        2 {:user/email &quot;another@example.com&quot;
           :user/name  &quot;Sam&quot;}})
     (pbir/constantly-resolver :all-users
       [{:user/id 1}
        {:user/id 2}])
     user-display-name]))

(p.eql/process opt-env
  [{:all-users [:user/display-name]}])
; =&gt; {:all-users
;     [{:user/display-name &quot;user@example.com&quot;} ; no name, use email
;      {:user/display-name &quot;Sam&quot;} ; has name (the optional), use it
;     ]}
</code></pre><p>Since Pathom 3 <code>2022.10.18-alpha</code> you can also use the <code>:or</code> section of the map destructing
to inform Pathom about optionals:</p><pre><code class="language-clojure">(pco/defresolver user-display-name
  [{:user/keys [email name] :or {name nil}}]
  {:user/display-name (or name email)})
</code></pre><h2 id="nested-inputs">Nested inputs</h2><p>Pathom supports requiring nested inputs on a resolver. This feature is handy when you
need to make data aggregation based on indirect data.</p><p>To illustrate this, consider the following setup:</p><pre><code class="language-clojure">(pco/defresolver top-players
  &quot;Return maps with ids for the top players in a given game.&quot;
  []
  {:game/top-players
   [{:player/id 1}
    {:player/id 20}
    {:player/id 8}
    {:player/id 2}]})

(pco/defresolver player-by-id
  &quot;Get player by id, in our case just generate some data based on the id.&quot;
  [{:keys [player/id]}]
  {:player/name (str &quot;Player &quot; id)
   :player/score (* id 50)})
</code></pre><p>Now, for the task: how to make a resolver that computes the average score from the top
players?</p><p>If you use the flat inputs as we did before and ask for <code>:game/top-players</code> it will
contain the ids, but not the scores. To make the scores available, a nested processing
is required in this case, and this where nested inputs come to rescue:</p><pre><code class="language-clojure">(pco/defresolver top-players-avg
  &quot;Compute the average score for the top players using nested inputs.&quot;
  [{:keys [game/top-players]}]
  ; we have to make the nested input explicit
  {::pco/input [{:game/top-players [:player/score]}]}
  {:game/top-players-avg-score
   (let [score-sum (transduce (map :player/score) + 0 top-players)]
     (double (/ score-sum (count top-players))))})

(p.eql/process (pci/register [top-players player-by-id top-players-avg])
  [:game/top-players-avg-score])
; =&gt; #:game{:top-players-avg-score 387.5}
</code></pre><p>When Pathom is planning, it will verify if a sub-query part reachable. If there is
no available path to fulfill the nested part, the planner will discard that path, avoiding
running unnecessary work on the runner.</p><p>You can try this by asking for a nested property that doesn&#x27;t exist.</p><h2 id="parameters">Parameters</h2><p>Parameters are a secondary layer to send information to a resolver. One main difference
between params and inputs is that params do not participate in the graph traversal; they
come as-is.</p><p>You can use parameters to allow the user to configure the request for some attribute.</p><p>To illustrate, lets start with a resolver that pulls todo from some mock memory data:</p><pre><code class="language-clojure">(def mock-todos-db
  [{::todo-message &quot;Write demo on params&quot;
    ::todo-done?   true}
   {::todo-message &quot;Pathom in Rust&quot;
    ::todo-done?   false}])

(pco/defresolver todos-resolver [env _]
  ; express nested shape
  {::pco/output
   [{::todos
     [::todo-message
      ::todo-done?]}]}
  {::todos mock-todos-db})

(def env (pci/register todos-resolver))

; list all todos
(p.eql/process env [::todos])
</code></pre><admonition type="note"><p>We are using explicit output in the <code>todos-resolver</code> so Pathom has more information about
the structured shape. Although the resolver works without the nested specification, having
it makes it possible for tools to auto-complete better, and this is important when
trying to integrate Pathom indexes, so as a general practice, when resolvers have nested
data, it&#x27;s better always to specify it.</p></admonition><p>To add params to a query attribute, we can use <a href="https://edn-query-language.org/eql/1.0.0/specification.html#_parameters">EQL params</a>,
for example:</p><pre><code class="language-clojure">; list undone todos:
(p.eql/process env [&#x27;(::todos {::todo-done? false})])
</code></pre><p>If we just ran the previous code, nothing happens. To make this work, we need to use
the parameters to filter the data in the resolver code.</p><p>To pull the params we can use the helper <code>(pco/params env)</code>, then filter the list based
on it:</p><pre><code class="language-clojure" metastring="{14-18,22-24}">(def mock-todos-db
  [{::todo-message &quot;Write demo on params&quot;
    ::todo-done?   true}
   {::todo-message &quot;Pathom in Rust&quot;
    ::todo-done?   false}])

(pco/defresolver todos-resolver [env _]
  {::pco/output
   [{::todos
     [::todo-message
      ::todo-done?]}]}

  {::todos
   ; pull params and filter
   (if-some [done? (get (pco/params env) ::todo-done?)]
     (-&gt;&gt; mock-todos-db
          (filter #(= done? (::todo-done? %))))
     mock-todos-db)})

(def env (pci/register todos-resolver))

; list undone todos
(p.eql/process env
  &#x27;[(::todos {::todo-done? false})])
</code></pre><p>To use parameters with <a href="/docs/smart-maps">Smart Maps</a> you need to call <code>sm-preload!</code> before
looking up the key, for example:</p><pre><code class="language-clojure">(def sm (psm/smart-map env {}))

; preload using EQL params
(psm/sm-preload! sm &#x27;[(::todos {::todo-done? false})])

(::todos sm) ; =&gt; cached filtered li
</code></pre><admonition type="tip"><p>Example implementation using a more generic function to filter data:</p><pre><code class="language-clojure">(defn filter-matches [match coll]
  (let [match-keys (keys match)]
    (if (seq match)
      (filter
        #(= match
            (select-keys % match-keys))
        coll)
      coll)))

(pco/defresolver todos-resolver [env _]
  {::pco/output
   [{::todos
     [::todo-message
      ::todo-done?]}]}

  {::todos
   (filter-matches (pco/params env) mock-todos-db)})
</code></pre></admonition><h2 id="resolver-transform">Resolver Transform</h2><p>It&#x27;s possible to send a function to transform the resolver before its instantiation.</p><p>This allows to create some helpers that you may want to apply only to some specific
resolvers.</p><p>As an example, let&#x27;s make a transform function that transforms a single resolver in
a batch resolver:</p><pre><code class="language-clojure">; note in practice there is usually no reason to do this, since processing as a batch
; is not more efficient than letting Pathom do it (and may be slower due to some overhead
; add by the batching mechanisms)
(defn batchfy
  &quot;Convert a resolver in a batch version of it.&quot;
  [resolver]
  (-&gt; resolver
      (assoc ::pco/batch? true)
      (update ::pco/resolve
        (fn [resolve]
          (fn [env inputs]
            (mapv #(resolve env %) inputs))))))

(pco/defresolver simple-resolver [{:keys [user/id]}]
  {::pco/output    [:user/name]
   ::pco/transform batchfy}
  ...)
</code></pre><p>The transform function receives the configuration map of the resolver (including the
execution function, as <code>::pco/resolve</code>). Then Pathom uses the returned map to instantiate
the resolver.</p><h2 id="batch-resolvers">Batch resolvers</h2><p>Batch in Pathom is the process of calling a resolver once with a batch of inputs. So
instead of running the resolver once for each item, it runs the resolver one time with
a sequence of inputs.</p><admonition type="tip"><p>Another way to put it: it&#x27;s how Pathom deals with the <a href="https://duckduckgo.com/?q=n%2B1+problem&amp;t=h_&amp;ia=web">N+1 problem</a>.</p></admonition><p>Here is a resolver that simulates a delay, let&#x27;s run in a list and check the time:</p><pre><code class="language-clojure">(pco/defresolver fetch-v [{:keys [id]}]
  (Thread/sleep 300)
  {:v (* 10 id)})

(time
  (p.eql/process
    (pci/register fetch-v)
    {:list [{:id 1}
            {:id 2}
            {:id 3}]}
    [{:list [:v]}]))
; &quot;Elapsed time: 903.389738 msecs&quot;
; =&gt; {:list [{:v 10} {:v 20} {:v 30}]}
</code></pre><p>As we can see, the ~900ms is expected since the resolver ran once for each item.</p><p>Consider a case where some API has a batching feature; in this case, would be ideal
to reduce the number of round trips, you can do it by writing a batch resolver. The main
the difference is that, instead of an input map, you will get a sequence of maps, with all
the inputs collected for batching. Use this to return a list (of the same input size)
and Pathom does the merging in place:</p><pre><code class="language-clojure" metastring="{5-21}">(pco/defresolver fetch-v [{:keys [id]}]
  (Thread/sleep 300)
  {:v (* 10 id)})

(pco/defresolver batch-fetch-v [items]
  {::pco/input  [:id]
   ::pco/output [:v]
   ::pco/batch? true}
  (Thread/sleep 300)
  (mapv #(hash-map :v (* 10 (:id %))) items))

(time
  (p.eql/process
    (pci/register batch-fetch-v)
    {:list [{:id 1}
            {:id 2}
            {:id 3}]}
    [{:list [:v]}]))
; &quot;Elapsed time: 302.606045 msecs&quot;
; =&gt; {:list [{:v 10} {:v 20} {:v 30}]}
</code></pre><h3 id="matching-results">Matching results</h3><p>It&#x27;s important that the output sequence of a batch resolver has the size and order as
the input. Sometimes API&#x27;s return things out of order, sometimes it misses items. To
see an example, let&#x27;s shuffle the order of our batch results and see what happens to
the results:</p><pre><code class="language-clojure">(pco/defresolver batch-fetch-v-reorder [items]
  {::pco/input  [:id]
   ::pco/output [:v]
   ::pco/batch? true}
  (Thread/sleep 300)
  (let [results
        (-&gt;&gt; items
             ; note we add the id again so the re-order function can match this item with the source
             (mapv #(hash-map :id (:id %) :v (* 10 (:id %))))
             ; make the order random
             (shuffle))]
    results))

(p.eql/process
  (pci/register batch-fetch-v-reorder)
  {:list [{:id 1}
          {:id 2}
          {:id 3}]}
  [{:list [:id :v]}])
; =&gt; {:list [{:id 1, :v 20} {:id 2, :v 30} {:id 3, :v 10}]}
</code></pre><p>Another thing that can ruin the matching is if there are missing records, but if that
happens Pathom will trigger an error</p><pre><code class="language-clojure">(pco/defresolver batch-fetch-v-reorder [items]
  {::pco/input  [:id]
   ::pco/output [:v]
   ::pco/batch? true}
  (Thread/sleep 300)
  (let [results
        (-&gt;&gt; items
             ; note we add the id again so the re-order function can match this item with the source
             (mapv #(hash-map :id (:id %) :v (* 10 (:id %))))
             ; make the order random
             (shuffle)
             ; drop some item
             (drop 1))]
    results))
</code></pre><p>To fix these problems you can use the helper <code>restore-order</code> from
<a href="https://cljdoc.org/d/com.wsscode/cljc-misc/2020.12.01/api/com.wsscode.misc.coll#restore-order">cljc misc</a>:</p><admonition type="note"><p>In the following example we alias <code>[com.wsscode.misc.coll :as coll]</code>.</p></admonition><pre><code class="language-clojure">(pco/defresolver batch-fetch-v-reorder-fixed [items]
  {::pco/input  [:id]
   ::pco/output [:v]
   ::pco/batch? true}
  (Thread/sleep 300)
  (let [results
        (-&gt;&gt; items
             ; note we add the id again so the re-order function can match this item with the source
             (mapv #(hash-map :id (:id %) :v (* 10 (:id %))))
             ; make the order random
             (shuffle)
             ; drop some item
             (drop 1))]
    (coll/restore-order items :id results)))
</code></pre><h3 id="batch-in-parallel-processor">Batch in Parallel processor</h3><p>Batching works a bit differently in the parallel processor.</p><p>In parallel execution we don&#x27;t have a clear signal that we finished a scan on the query.</p><p>For that reason we need another way to decide we accumulated enough and trigger the
batch request.</p><p>The strategy in the parallel case is based on two configurations:</p><p><code>::pcrp/batch-hold-delay-ms</code> - After not receiving a new entry for an amount of milliseconds,
Pathom will fire the batch with the items accumulated so far.
<code>::pcrp/batch-hold-flush-threshold</code> - When the accumulator reaches the threshold, it
triggers the batch immediately.</p><h3 id="batch-in-chunks">Batch in chunks</h3><p>Since Pathom 3 <code>2022.03.04-alpha</code>, the batch mode supports defining a chunk size.</p><p>This is specially useful when dealing with large data sets where the input size might
go over some limit on the external system:</p><pre><code class="language-clojure">(pco/defresolver batch-fetch-v-reorder-fixed [items]
  {::pco/input  [:id]
   ::pco/output [:v]
   ::pco/batch? true
   ::pco/batch-chunk-size 10}
  (Thread/sleep 300)
  (let [results
        (-&gt;&gt; items
             ; note we add the id again so the re-order function can match this item with the source
             (mapv #(hash-map :id (:id %) :v (* 10 (:id %))))
             ; make the order random
             (shuffle)
             ; drop some item
             (drop 1))]
    (coll/restore-order2 items :id results)))
</code></pre><p>In the previous setup, now if we have for example 25 items, instead of a single call with
25 items, we will get 2 calls with 10 items and one with 5 items.</p><h3 id="unsupported-batch">Unsupported batch</h3><p>Not all paths are supported in batch, for example:</p><pre><code class="language-clojure">(p.eql/process
  (pci/register
    [(pco/resolver &#x27;batch
       {::pco/input  [:foo]
        ::pco/output [:bar]
        ::pco/batch? true}
       (fn [_ items]
         (mapv #(hash-map :bar (* 10 (:foo %))) items)))])
  {:items #{{:foo 1} {:foo 2}}}
  [{:items [:bar]}])
; Sun Feb 07 13:31:00 BRT 2021 WARN :com.wsscode.pathom3.connect.runner/event-batch-unsupported - {:com.wsscode.pathom3.path/path [:items 0], :com.wsscode.pathom3.connect.operation/op-name batch}
; Sun Feb 07 13:31:00 BRT 2021 WARN :com.wsscode.pathom3.connect.runner/event-batch-unsupported - {:com.wsscode.pathom3.path/path [:items 1], :com.wsscode.pathom3.connect.operation/op-name batch}
; =&gt; {:items #{{:bar 10} {:bar 20}}}
</code></pre><p>In cases like these, you will a warning telling you that batching is unsupported. The reason
for this behavior is due to how batching works. Pathom collects entries for batch, and they
run all together at the root entity context. Once the results are available, Pathom has
to inject the response back into the tree.</p><p>The process works fine with maps and vectors but not with sequences, lists, or sets. That&#x27;s
because the later data structures don&#x27;t support indexed updates for the elements in them.</p><p>When Pathom knows it is such path, it won&#x27;t try to batch. It runs the resolver using a
single collection element and gets the first result. This is effective the same as using
the resolver without batching.</p><p>If you see the warning, check the tree and find the collection that&#x27;s isn&#x27;t a vector
and then you can fix it.</p><h3 id="dont-overuse-batch">Don&#x27;t overuse batch</h3><p>Don&#x27;t batch when the resolver operation is quick. If there is no IO in the
resolver, consider keeping it non-batched. Also, if you are using SQLite, <a href="https://www.sqlite.org/np1queryprob.html">you don&#x27;t need to batch at all</a>.</p><h2 id="prioritization">Prioritization</h2><p>There are cases where multiple paths are available to get the same data.</p><h3 id="priority-number">Priority number</h3><p>You can use the attribute <code>::pco/priority</code> to indicate to Pathom that a resolver is
preferred. The value of <code>::pco/priority</code> is an integer. If not set, the default value
is zero. Negative values are allowed.</p><admonition type="caution"><p>This method of prioritization still experimental and subject to change, join the
discussion at <a href="https://github.com/wilkerlucio/pathom3/discussions/57">https://github.com/wilkerlucio/pathom3/discussions/57</a>.</p></admonition><p>To demonstrate the usage of priority, the following example shows two versions
to get the name, one from cache (preferred), but falling back to the standard db
one when the cache is unable to deliver.</p><pre><code class="language-clojure">(pco/defresolver db-user-by-id [{:user/keys [id]}]
  {:user/name (str &quot;Name from DB &quot; id)})

(pco/defresolver cache-server-user-by-id [{:user/keys [id]}]
  ; here we increase the priority of the external cache resolver
  {::pco/priority 1}
  {:user/name
   (if (even? id)
     (str &quot;Name from Cache &quot; id)
     ::pco/unknown-value)})

(p.eql/process (pci/register [db-user-by-id cache-server-user-by-id])
  [{[:user/id 1] [:user/name]}])
; =&gt; {[:user/id 1] #:user{:name &quot;Name from DB 1&quot;}}

(p.eql/process (pci/register [db-user-by-id cache-server-user-by-id])
  [{[:user/id 2] [:user/name]}])
; =&gt; {[:user/id 2] #:user{:name &quot;Name from Cache 2&quot;}}
</code></pre><admonition type="tip"><p>You can see that the cached resolver returns <code>::pco/unknown-value</code>. This is equivalent to not having
that key in the response. Doing this way, we can leverage the output inference while expressing this value is unknown, which triggers the next option.</p></admonition><p>It&#x27;s important to notice that Pathom will choose will depend on the highest priority
resolver on that path. This means a dependency with a high priority may override the
priority of an &quot;end resolver&quot;.</p><p>Here is an example of this scenario:</p><pre><code class="language-clojure">(p.eql/process
  (pci/register
    [(pco/resolver &#x27;high-priority-dep
       {::pco/priority 5 ; very high priority
        ::pco/output   [:dep]}
       (fn [_ _] {:dep &quot;value&quot;}))

     (pco/resolver &#x27;a1
       {::pco/priority 1
        ::pco/input    [:dep]
        ::pco/output   [:a]}
       (fn [_ _]
         {:a 1}))

     ; this is higher on priority than a1, and has no deps
     (pco/resolver &#x27;a2
       {::pco/priority 2
        ::pco/output   [:a]}
       (fn [_ _]
         {:a 2}))])
  [:a])
; =&gt; {:a 1} ; the lower priority for `:a` won, because the `:dep` on that path had the highest priority
</code></pre><p>Here is the graph to help visualize it:</p><div class="pathom-plan-view"><div class="loading-container">Loading viz data...</div></div><h3 id="custom-priority-algorithm">Custom priority algorithm</h3><p>If you need fine control over prioritization, you can set the key <code>::pcr/choose-path</code>
in the env, to provide your custom function.</p><p>To understand how to make a custom priority function, you must first understand
how the Pathom planner works. Especially the part on <code>OR</code> nodes, <a href="/docs/planner#or-nodes-1">you can find it here</a>.</p><p>This is the default <code>choose-path</code> implementation:</p><pre><code class="language-clojure">(defn default-choose-path [env or-node node-ids]
  (-&gt; (priority-sort env node-ids)
      first))
</code></pre><p>It takes an environment (which has the graph inside at <code>::pcp/graph</code>), the <code>OR</code> node
in process and a set of <code>node-ids</code>, from which you should pick one.</p><p>Sometimes, the <code>OR</code> node branches could be as simple as two resolvers to choose
from. In other cases, it can be huge, with a complex run graph underneath. So you must
consider this if you are writing a custom prioritization function.</p><p>To illustrate this, let&#x27;s see how Pathom implements <code>priority-sort</code>. The algorithm traverses each of the <code>OR</code> branches to find their leaf nodes for priority sort. This way
we compare the edges (which does what you would expect).</p><p>After comparing the edges, we need to return the original branch node, so we store it as
part of the data.</p><p>Some leaf nodes may be other branch nodes. In those cases, we run the prioritization
again against those nodes, and take the winner to compare also with the parent items.</p><p>To finish up, compare the now generates leaves and take the winner path.</p><pre><code class="language-clojure">(defn priority-sort [{::pcp/keys [graph] :as env} node-ids]
                        ; start from the node ids
  (let [nodes-data (-&gt;&gt; node-ids
                        ; map over, navigating to the leaf nodes, and associating back the original id,
                        (map #(-&gt; graph
                                  (pcp/find-leaf-node (pcp/get-node graph %))
                                  ; adding the source information to use in the end
                                  (assoc ::source-node-path %)))
                        ; this map takes care of expanding branch nodes
                        (map (fn [{::keys [source-node-path] :as node}]
                               (if-let [branches (pcp/node-branches node)]
                                 (-&gt; graph
                                     (pcp/get-node (first (priority-sort env branches)))
                                     (assoc ::source-node-path source-node-path))
                                 node)))
                        ; load the config of the reached nodes
                        (keep #(pcp/node-with-resolver-config graph env %)))]
    ; sort by priority
    (mapv ::source-node-path (sort-by #(or (::pco/priority %) 0) #(compare %2 %) nodes-data))))
</code></pre><p>When you override <code>::pcr/choose-path</code>, you can start by copying the <code>default-choose-path</code>
you saw before here, and adjust it for your needs.</p><h2 id="using-resolver">Using <code>resolver</code></h2><p>You can also create a resolver using the <code>resolver</code> helper. This is more useful when
you are making some helper function to generate a resolver.</p><p>To create a resolver using <code>pco/resolver</code> you have the following options:</p><pre><code class="language-clojure">; using helper syntax
(pco/resolver `op-name
  {::pco/output [::foo]}
  (fn [env input] {::foo &quot;bar&quot;}))

; using config map
(pco/resolver
  {::pco/op-name `op-name
   ::pco/output  [::foo]
   ::pco/resolve (fn [env input] {::foo &quot;bar&quot;})})
</code></pre><p>As an example, here are how to generate resolvers to create unit conversion between
meters and foot to a given attribute name:</p><pre><code class="language-clojure">(defn meter&lt;-&gt;feet-resolver
  [attribute]
  (let [foot-kw  (keyword (namespace attribute) (str (name attribute) &quot;-ft&quot;))
        meter-kw (keyword (namespace attribute) (str (name attribute) &quot;-m&quot;))]
    [(pbir/single-attr-resolver meter-kw foot-kw #(* % 3.281))
     (pbir/single-attr-resolver foot-kw meter-kw #(/ % 3.281))]))

(let [sm (psm/smart-map (pci/register (meter&lt;-&gt;feet-resolver :foo)))]
  [(-&gt; sm (assoc :foo-m 169) :foo-ft)
   (-&gt; sm (assoc :foo-ft 358) :foo-m)])
; =&gt; [554.489 109.11307528192624]
</code></pre><h2 id="resolver-environment">Resolver environment</h2><p>The environment is a map containing contextual information about the process. You can find
information about environment details at the <a href="/docs/environment">environment page</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wilkerlucio/pathom3-docs/edit/master/docs/resolvers.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/nouns"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Nouns</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/built-in-resolvers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Built-in Resolvers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-a-resolver-in-pathom" class="table-of-contents__link toc-highlight">What is a resolver in Pathom?</a></li><li><a href="#using-defresolver" class="table-of-contents__link toc-highlight">Using <code>defresolver</code></a></li><li><a href="#invoking-resolvers" class="table-of-contents__link toc-highlight">Invoking resolvers</a><ul><li><a href="#using-the-indexes" class="table-of-contents__link toc-highlight">Using the indexes</a></li></ul></li><li><a href="#optional-inputs" class="table-of-contents__link toc-highlight">Optional inputs</a></li><li><a href="#nested-inputs" class="table-of-contents__link toc-highlight">Nested inputs</a></li><li><a href="#parameters" class="table-of-contents__link toc-highlight">Parameters</a></li><li><a href="#resolver-transform" class="table-of-contents__link toc-highlight">Resolver Transform</a></li><li><a href="#batch-resolvers" class="table-of-contents__link toc-highlight">Batch resolvers</a><ul><li><a href="#matching-results" class="table-of-contents__link toc-highlight">Matching results</a></li><li><a href="#batch-in-parallel-processor" class="table-of-contents__link toc-highlight">Batch in Parallel processor</a></li><li><a href="#batch-in-chunks" class="table-of-contents__link toc-highlight">Batch in chunks</a></li><li><a href="#unsupported-batch" class="table-of-contents__link toc-highlight">Unsupported batch</a></li><li><a href="#dont-overuse-batch" class="table-of-contents__link toc-highlight">Don&#39;t overuse batch</a></li></ul></li><li><a href="#prioritization" class="table-of-contents__link toc-highlight">Prioritization</a><ul><li><a href="#priority-number" class="table-of-contents__link toc-highlight">Priority number</a></li><li><a href="#custom-priority-algorithm" class="table-of-contents__link toc-highlight">Custom priority algorithm</a></li></ul></li><li><a href="#using-resolver" class="table-of-contents__link toc-highlight">Using <code>resolver</code></a></li><li><a href="#resolver-environment" class="table-of-contents__link toc-highlight">Resolver environment</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Presentations</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.youtube.com/watch?v=YaHiff2vZ_o" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Navigation with Pathom 3<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=IS3i3DTUnAI" target="_blank" rel="noopener noreferrer" class="footer__link-item">Conj 2019 - The Maximal Graph<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=yyVKf2U8YVg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Conj 2018 - Scaling Full Stack Applications<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=r3zywlNflJI" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dutch Clojure Days 2018 - Clojure Graph API’s<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://clojurians.slack.com/messages/pathom/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Wilker Lucio</div></div></div></footer></div>
<script src="/assets/js/runtime~main.feaca457.js"></script>
<script src="/assets/js/main.5057d4a7.js"></script>
</body>
</html>