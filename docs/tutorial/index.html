<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.64">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GZFCYV0DXN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-GZFCYV0DXN",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Pathom 3" href="/opensearch.xml"><title data-react-helmet="true">Pathom Tutorial - IP Weather | Pathom 3</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Pathom Tutorial - IP Weather | Pathom 3"><meta data-react-helmet="true" name="description" content="The task of this tutorial is to implement a series of resolvers that can tell the current"><meta data-react-helmet="true" property="og:description" content="The task of this tutorial is to implement a series of resolvers that can tell the current"><meta data-react-helmet="true" property="og:url" content="https://pathom3.wsscode.com/docs/tutorial"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://pathom3.wsscode.com/docs/tutorial"><link rel="stylesheet" href="/styles.4444d5c6.css">
<link rel="preload" href="/styles.488f8ab7.js" as="script">
<link rel="preload" href="/runtime~main.868e945b.js" as="script">
<link rel="preload" href="/main.25d8d50a.js" as="script">
<link rel="preload" href="/1.89ba2929.js" as="script">
<link rel="preload" href="/2.ab7b01d4.js" as="script">
<link rel="preload" href="/3.28552344.js" as="script">
<link rel="preload" href="/1be78505.fdabaee1.js" as="script">
<link rel="preload" href="/46.50848efd.js" as="script">
<link rel="preload" href="/935f2afb.b0430d98.js" as="script">
<link rel="preload" href="/17896441.da245a3d.js" as="script">
<link rel="preload" href="/6eb54612.693d008c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/icon_64x64.png" alt="Pathom 3"><strong class="navbar__title">Pathom 3</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://blog.wsscode.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a class="navbar__item navbar__link" href="/media">Media</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wilkerlucio/pathom3" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/icon_64x64.png" alt="Pathom 3"><strong class="navbar__title">Pathom 3</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://blog.wsscode.com" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/media">Media</a></li><li class="menu__list-item"><a href="https://github.com/wilkerlucio/pathom3" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Getting Started</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs/tutorial">Pathom Tutorial</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Using Pathom</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/resolvers">Resolvers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/built-in-resolvers">Built-in Resolvers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/smart-maps">Smart Maps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/eql">EQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/environment">Environment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cache">Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/placeholders">Placeholders</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mutations">Mutations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/error-handling">Error Handling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugins">Plugins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/built-in-plugins">Built-in Plugins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/async">Async</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/debugging">Debugging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/foreign">Foreign Environments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/dynamic-resolvers">Dynamic Resolvers</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How Pathom Works</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/indexes">Indexes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/planner">Planner</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/shape-descriptor">Shape Descriptor</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Integrations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/integrations/graphql">GraphQL</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/hacker-news-scraper">Hacker News Scraper</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/serverless-pathom-gcf">Serverless Pathom with GCF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/babashka">Scripting with Babashka</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/graphql-integration">GraphQL Integration</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Pathom Tutorial - IP Weather</h1></header><div class="markdown"><p>The task of this tutorial is to implement a series of resolvers that can tell the current
temperature, based on some IP address.</p><p>To implement this, I&#x27;ll use <a href="https://get.geojs.io" target="_blank" rel="noopener noreferrer">GeoJS</a> to find the location from some
given IP, and then use <a href="http://www.7timer.info/doc.php?lang=en#api" target="_blank" rel="noopener noreferrer">7timer</a> to find the temperature.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="app-setup"></a>App Setup<a aria-hidden="true" tabindex="-1" class="hash-link" href="#app-setup" title="Direct link to heading">#</a></h2><p>In this demo, I&#x27;ll be using <a href="https://clojure.org/guides/deps_and_cli" target="_blank" rel="noopener noreferrer">Clojure Deps</a> to manage the dependencies:</p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">deps.edn</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{:paths</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [&quot;src&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> :deps</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> {cheshire/cheshire   {:mvn/version &quot;5.10.0&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  com.wsscode/pathom3 {:mvn/version &quot;2022.10.19-alpha&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  org.clojure/clojure {:mvn/version &quot;1.11.1&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  http-kit/http-kit   {:mvn/version &quot;2.5.3&quot;}}}</span></div></div></div></div></div><p>We are going to use <code>http-kit</code> to make our requests and <code>cheshire</code> to parse <code>JSON</code> from
the API responses.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="command-line-application"></a>Command Line Application<a aria-hidden="true" tabindex="-1" class="hash-link" href="#command-line-application" title="Direct link to heading">#</a></h2><p>To run our application, we will use the <code>:exec-fn</code> feature from <code>deps.edn</code>, I&#x27;ll start
setting up the main entry point and show how to trigger it from the command line:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(ns com.wsscode.pathom3.demos.ip-weather)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(defn main [{:keys [ip]}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (println &quot;Request temperature for the IP&quot; ip))</span></div></div></div></div></div><p>To test this, run the following:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">clj -X com.wsscode.pathom3.demos.ip-weather/main :ip </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&quot;198.29.213.3&quot;&#x27;</span></div></div></div></div></div><p>To make this command shorter, add an alias to <code>deps.edn</code>:</p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">deps.edn</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{:paths</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> [&quot;src&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> :deps</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> {cheshire/cheshire   {:mvn/version &quot;5.10.0&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  com.wsscode/pathom3 {:mvn/version &quot;2022.10.19-alpha&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  org.clojure/clojure {:mvn/version &quot;1.11.1&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  http-kit/http-kit   {:mvn/version &quot;2.5.3&quot;}}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain"> ; add alias to make easier to call</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain"> :aliases</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain"> {:ip-weather</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">  {:exec-fn com.wsscode.pathom3.demos.ip-weather/main}}}</span></div></div></div></div></div><p>Now we can run:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">clj -X:ip-weather :ip </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&quot;198.29.213.3&quot;&#x27;</span></div></div></div></div></div><p>Scaffolding is done. Time to start writing some application logic.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="start-from-the-tail"></a>Start from the tail<a aria-hidden="true" tabindex="-1" class="hash-link" href="#start-from-the-tail" title="Direct link to heading">#</a></h3><p>First, let&#x27;s understand the data scenario for this task. If we start assuming that we know
nothing about the services involved, we still know what we have (the IP) and what we
want (the temperature), we can start with this graph representation:</p><div class="pathom-diagram"><p>  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAABSCAIAAACqm5rZAAAAAXNSR0IArs4c6QAAAJBlWElmTU0AKgAAAAgABgEGAAMAAAABAAIAAAESAAMAAAABAAEAAAEaAAUAAAABAAAAVgEbAAUAAAABAAAAXgEoAAMAAAABAAIAAIdpAAQAAAABAAAAZgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAAUCgAwAEAAAAAQAAAFIAAAAACHnglAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAgtpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpSZXNvbHV0aW9uVW5pdD4yPC90aWZmOlJlc29sdXRpb25Vbml0PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpDb21wcmVzc2lvbj41PC90aWZmOkNvbXByZXNzaW9uPgogICAgICAgICA8dGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPjI8L3RpZmY6UGhvdG9tZXRyaWNJbnRlcnByZXRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CtQK6igAABJFSURBVHgB7Z0HeFTFFsfpNYChBkLvoggEREABgUAEaQnNJNIUY6RKfRCkV8kDRHngA4QYEJAQOh8l0ptIlfqFKp2ASAsQ+vsto/PW3SwmwC67e8/9+JYzZ86cOfOfe+6cOXM3myJFipQp5BIEBAGXRCClyXvXrXvsksaL0UlAoFatlDK/ScDJJUWY3FQuabgYLQgIAk8QEAeWG0EQcGEExIFdePLEdEFAHFjuAUHAhREQB3bhyRPTBQFxYLkHBAEXRkAc2IUnT0wXBMSB5R4QBFwYAXFgF548MV0QEAeWe0AQcGEExIFdePLEdEFAHFjuAUHAhRFI48K2/5Pp8+dP+M9/uo8fv658+ZoREYO//36obpEqVapcufJXqfJ+hw4jPDxe0Xwhng2B+PjrjRp52mo7duxPPj61bdU6A3/nzphMmbKUKVPFGYxJlg3u7MCPHj1MkeLxk88Ujx49gm7c+LM8eQoB0NmzR7ZvX7F48aSrV+OGDJmfLMhE2BqBDBkyhYSMfvzY9LW2CxdOLFs2pVKlehUq/Om0BQuWtm7iVJx//zukVKlKQ4ZEOZVVSTHGnR3YevwNG35SokQFxX/w4H7z5t4bN0bfuROfMaOHtbBwko5AmjRpAwP7KPm9e9crB27VqmfSNYjksyFg3D0w91zFir6gdunSmWfDTlolEYHY2J09etRp0CBrmzalJ03qef/+PRreunUjJKTi2rVzw8M7NGuWLyAg75QpfWEOHx7cpEnOhg09hw0LunPnFpI7dqxGMiZmVteuNerXzxIcXHzChC53797RvS9cOPHjj8v5+WXq1q1mTMwPio/8p59WunbtMnpQePXqpT/+uDhyZBt//zx16qQJCPCaOLH7w4cPDxzYivIrV87v2vUTxN69GzZuXPCEc0Hr79nTd8aMQRStdbJ3wP4WLQrQxaBBLU6dOqxbOYYwrgMzeb/+ugGUc+b0dgzWxuzl0KHtnTu/HRd3umnTToULvxYVNW7o0A+Agq3N0aO78ShcyM+vbe7cBebM+bJdu9d2715Tu3ZgyZI+a9fOmTt3DJLXr//+RLJ1QsItf/9OXl5FFi2a2K9fQ4Xn1KlhX3/dJUeOvM2bf37z5tWRI1v/9NNsqv74I+7IkV3DhgVu2rTAy6tw2rTpv/jCf82aOeXK1WzTZiBKoqO/WrlyRoYMmQsUKMXTPF26DBDsBVR39KX083n8+L6LF3+z1slfs+ncuRqPjGrVGtWt++HOnat5Tjl4PTBWCL1169ITJ/YzE+fPH9+yZTHPXR+fOpkzZ4Ujl50QmDy5l6dnnilTdimcIyKGfP/94CNHdufNW4QeSUl8++2OjBkzs0IGBOS5cePKwoVx5JNYpf39cx87tldbVbZsdZJhadOmg8OWdfnyqWSe8ucvOW/e2AYNOvTuPRV+u3aDO3aswmrp6xukGuJ4M2Yc9PYu9vvv5w8f/rlu3dZhYZFUtWzZo0GDLOh///0OAwbM/uCDIuyBIag6enSPamvrU+uMjv761KlD4eGrK1Wqi/B777UPDX1z0aJJISGjbLV94XxjOXBEhCkQ0lf58rX69Jmui0K8cATu3Us4eHAr2f59+zYp5XnyFITYunVJs2bdIGrXboX3Qnh65mYxrFz5PbyXIo5KZKSCbYpcyCvvhQ4M/BcOvGfPOtz+wYN7+fOX2LZt+ROpFEWKvB4TM/PkyYOq2Lr1ALwXGv3R0Rc9PLLFx1+jdvPmRTAfPnygxJL1qXXu2bPWw8MTI3XvHG0wNHHgZOGZDOHBg6MKFSpDg5QpU4K1uleS0V5Ek4kAi9Xjx4+2bVvKP/OmbEdVMX36TJqfMmWqbNlymhX/9ucWvb2L66p8+YpCx8WdSp8+I8SUKf/SVYrQ+llXFSd16jS7dsXMnj36t99Mvq0OIyxaJbGodZ4/fyI+/mpY2J/BvGqOSydRzwsRM9YKnC9fscKFTQ4sl2MQyJ7di44aNQpt3ty03uorc+Zsmk4icf36ZS3JXhc6a9YcSv+wYYsKFiylayF4OqvwO2vW7Iq/f/9m9tvlytUYP3598eLlWYrJh5k30bQ6DDMv3r59UxchtE56p2rMmBXmtTyGzIv2ph3amb0HI/qdDQFekiFdFBu7g/wQp8H8Iy3cu7cf6aXkmqrTyzRcv34en8WKvVGihA/E6dOHlXI+V66MIFmlvYhQS3X0JIZ/HBoazls9eO/p07EJCfF/91XTITaXOlNEQBVpeP9+gqLVp9bJkeTly2foS/VOqmzEiNZRUePNhe1NG2sFtjeaot8agaCgvuPGffrFF005hCczTGIZD6lcuf7t2zeshZ/CWbUq4knD986dO0rm2dPTy9c3mBDax8d3+vSBbLZfe63a4cPbf/xxLD2STLZQRSINzoIF32AGoW9k5FCKhNOXL5/Llcsb+djYXUuW/Ldq1YZFi5alavr0AVjIywLTpoVZqNJFtuUo7N27Xvv2Q9nAr1kzm2y5SqdpGXsTxnJg/WC2N6yin5dVFQg4DEcykZHDyO5wlkPisF27QalTp1ZzkSpVao0VTZ4yQQEBXVevnskBEhmMkiUr9u8/S22ABw36cdy40B9+GEU2Cy/182sTFGTaEisDtMI6dQLXr48iv8W/dOkykoXmzJYTJhbzFi2616//EQnO8eNDPT0XVK/uHxwcxm55+PAgtuitWvXasGH+X9aaBqV15syZjxd1w8M/Hj26Lfxixcp16TKB+FyPyAGEKcCQP/ztAKBfVhfO84fdOQpm16pyzslCg3PdESOCp0zZzdrI4omXEgNbaGCpRD/JLR3fWgioIllrdq3EujxBeLuWNBjZLP2sMW/Cks6JLmddZL/M+YnSZLYTEm7jz4nW2o/J5P6zcfbrXjQbCgF1gPQ8Q8aXChQomagG3sRQx0WJ1momh0n8U0X8Vp1F61pzgvc6OJ0y5zyFZqv/sr4SI0msp8yLVDkRAk9fWp3IUMeaIiuwY/GW3pKPAC8qRkbGcgSY/Kbu30Ic2P3n2NVHyPs28sqNrUmUENoWMsIXBFwAAXFgF5gkMVEQsIWAOLAtZIQvCLgAAuLALjBJYqIgYAsBcWBbyAhfEHABBMSBXWCSxERBwBYC4sC2kBG+IOACCIgDu8AkiYmCgC0ExIFtISN8QcAFEBAHdoFJEhMFAUFAEBAE3BAB0/eB//6HRdxwkEYeEl/ikfl11xuAyZUQ2l0nV8ZlCATEgQ0xzTJId0VAHNhdZ1bGZQgExIENMc0ySHdFQBzYXWdWxmUIBMSBDTHNMkh3RUAc2F1nVsZlCATEgQ0xzTJId0VAHNhdZ1bGZQgExIENMc0ySHdFQBzYXWdWxmUIBMSBDTHNRhhkXFzczz//fO7cOSMMVo/R0Q7crVs3Pz8/3T3EsWPHgoKCSpYs+eqrr3700UeXLl3StWfPnu3QoQNVRYoUadq06e7du3WVOfHw4cPRo0dXq1atQIECtWrVioqK0rV37twZOHDgm2++WbBgwXr16m3cuFFXWRAxMTENGjQoVKiQj4/PgAED4uPjLQSsLb97927//v2RR3nt2rUXL15s0UQXFyxYgED+/PkRHjp0KFbpKiGeH4HLly8zd15eXlWrVgVk6OvXrz+/WpfRwLdVHHDxY3Dz5s3LkCED7qS7O378eObMmbNnz96lS5c2bdrwm3G4UEJCAgK4UIkSJdKlS4dXt2vX7pVXXsmYMSPerttqIjg4GKx5LvTu3bto0aLQ3333HbX0+O6771JswQ9Idu/u7e3N71mt47cYra6FCxfyxY7ixYv36tULP6dJ/fr1aa4EE7WcKtQi6e/vHxISkieP6ednly1bZqX7MaOmqmzZsthQoUIFaIZjLWYnDt3ZSbPzqG3VqhX3yYQJE1iBO3bsyJA/++wz5zHPfpYwUtNlvw60ZpYvdYvTnbkDcyvD2blzp5KcPn06xYkTJ1JctWoV9JgxY1TVzJkzKY4YMULrVMThw4fxvcDAQFW8evUqHeEtFJcvX06Tvn37qiqCq6xZs9asWVMVzT+Rz50795UrVxTzww8/pCGaKdqynEcPMjx3VJNdu0w/OU8oYa5W0RUrVixcuPDt27cp8izgMcFT7MGDB9aS9uBglT3UOo/OmzdvMkbtsQDLk5qozXkstJ8lDNxBIXS5cuVYYFkhiXDwNzpWF1FxmTJluMVVsW3btunTp1+7di1FAmM+iU5VFT6gCItP5WZE2orPQl25cuWjR49SVCF369atVVW+fPkaNmy4adOm+/fvmyu5d+/ewYMHAwICCAQUXwX5Soktyw8dOoSwWoQhiI09PDysIzcmD8lGjRoRPiDG2KtXr44B+LPqSz6fEwHi59dff13FTagiiMOBjQOvg37crH379mqetm/fToRsPmfWP6985swZBFgq8ahRo0axN8aZhwwZkjZt2iZNmpi3hX7jjTdYt1VoSpEHMN5IHA6tnhTmzwuYrIHnz59XAhTVNW3atPLl///D6nv37oWvHhm2LOdZQF/cLkjikCNHjiTmZ6P+p8a//qN3+NoGHh/R0dHsh7NkyfKXiPz/XAiQH9m/f79WsW3bth07dqgYSjPdnLDfEm+tuUaNGqyQmk/oy829detWxVFxMk9QVSSxZA792LFjdcNECZzz888/pwlujwA7W+gePXoo4YsXL7I+w9myZUuizRVzzZo1RAEEBWgzF7OwXFf16dOHDRhq2YlppjVB/owAHrFcuXKxaFgL2IlDj3bS7IRqY2NjgZdQi+2SE5r3wk1ick3XC9f7FIUWbsDWkRWYO7tnz56kglhjyWmRiELDvn37CEopdu7cOSwsjFnBr+bOnWtLOf5JpMpwWAaJihFjhWT1htO8efN+/fqRo0YhRTpNVInKZmMDT5AjR45YyFhYrmtXrFjBzvztt9/mSURSWvMtCMIK9vPsEdKkScMj7Nq1axYCdio6eH7tNIqkqGXS2Y55enqyZ0mKvBvIMLmmy5EjsXYDdrzc0OR1SpUq9c0333AaVKVKFUzCabFt8+bNyjz8M0eOHO+8806i1i5atChnzpyshMOHD8cPtcyFCxdatmxJFdE4zkMtOvElLaCJkydP4oTUcghBX5qvCWvLdRUEyzWBMRtdjojM+db0pEmT6IWzLusqe3Doyx5qnVDnhg0bGOzkyZOd0DY7mcR4TZedtCeq1pYbqHiVNRMvZcGkLSdArMzmSjiwwUUtIlsEIiMjWcZJI7H7NZc3p1WrTz75hAWW81vzKugTJ06w6mbLlo0Y3qJKFy0sJ56vVKmS+UIKBzDZ5OsmEMQRGMa+VzNPnz6NGOdVmmNXwsHza9exPF35jBkzGCz5i6eLuVMt43VQFpqeEr04GsUn1VEQAoSjnOU0btwYmjzTjRs3WIFVQ3z7wIEDJJZ0QkjxefGjU6dOpHbZ2RJBKab6ZGuNMPthihC3bt1iV0yGWW1ZzSU5DSLVxDY1WckPTr9Y+bUeitDkVDQHgoiOZDjn0pqpDpwsxHStEM+MAOcIbHzUpumZlbhkQ0c+kyzWMTJGQMZSFhERwROU5ZfzWPwWk1auXInX8S5HeHg4jq32t8TAVBEYs+QSckN/9dVXaOjatStOoq/58+dTxUqbN29e1tUvv/wSDks6CpcsWWKhQb18R9yumyuCRwOS+rKw/NSpU+yoMZgkFkfWPEQwg/BbydMXFuK6FH19faGbNWuGt3PETRO8OtEwXvf1AgmseoHanFlVaGgoOM+ZM8eZjXyxtjG5puvFKn26NtxAbXG12NSpU9966y1ci4szIXWuq2o5H8IDlZGZMmUiRaT2t+xRYapcF8fLSsD8k3yV0sCqSOBNJoxaHg30pfjmGpYuXWreVtO//PKLNhLC2nKePqVLl1bypKbYY+tXQdirw9+zZw8NObXCBu4tJcnTiqMOc812penUrvqdRzn7IwY7a9Ys5zHJ3pYw3pRqgvl8uRfLHbtTliZrM1hvyQwRUatDV2uBf+SwFOOxFme//9gqiQI4La9/8cKJdWRuroHTb3a/vCVGRGDOtzfNY5HbyN69iP6XgoBp0aNjmeCXgr5jOhUHdgzOL6UXJvclJ7FeyrClU0HAbRAQB3abqZSBGBEBcWAjzrqM2W0QEAd2m6mUgRgRAXFgI866jNltEBAHdpuplIEYEQFxYCPOuozZbRAQB3abqZSBGBEBcWAjzrqM2W0QEAd2m6mUgRgRAXFgI866jNltEBAHdpuplIEYEgH1fQZDDl0GLQi4NgI47/8AK9fAn48p4wIAAAAASUVORK5CYII="></p></div><p>By looking at the documentation on the <a href="http://www.7timer.info/doc.php?lang=en#api" target="_blank" rel="noopener noreferrer">7timer</a>,
I see that the temperature information is present in the
<code>http://www.7timer.info/bin/api.pl?lon=$LONGITUDE$&amp;lat=$LATITUDE$&amp;product=astro&amp;output=json</code> endpoint
. This means that to fetch the temperature, we need some <code>latitude</code> and <code>longitude</code>.</p><div class="pathom-diagram"><p>  <img src="/assets/images/table-plan-1-2f0fb83a0f43186235d4e333d30d4760.png"></p></div><p>Using the GeoJS API, we can use the endpoint <code>https://get.geojs.io/v1/ip/geo/$IP$.json</code>
to figure the latitude and longitude, given some IP:</p><p>Now we have the complete path from the <code>IP</code> to the <code>temperature</code>.</p><div class="pathom-diagram"><p>  <img src="/assets/images/table-plan-2-1a8e40192d6ec22c13a4d6db548c21e1.png"></p></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>I found those API&#x27;s using the <a href="https://github.com/public-apis/public-apis" target="_blank" rel="noopener noreferrer">Public API&#x27;s</a>
service, I find it a great source to look for open API&#x27;s to play.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="resolvers"></a>Resolvers<a aria-hidden="true" tabindex="-1" class="hash-link" href="#resolvers" title="Direct link to heading">#</a></h3><p>In Pathom, resolvers are the main building blocks express attribute relationships.</p><p>To implement the resolvers, I&#x27;ll start with the one to fetch the latitude and longitude
from the IP:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(ns com.wsscode.pathom3.demos.ip-weather</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (:require</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [cheshire.core :as json]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [com.wsscode.pathom3.connect.operation :as pco]))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pco/defresolver ip-&gt;lat-long</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  [{:keys [ip]}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  {::pco/output [:latitude :longitude]}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (-&gt; (slurp (str &quot;https://get.geojs.io/v1/ip/geo/&quot; ip &quot;.json&quot;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      (json/parse-string keyword)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      (select-keys [:latitude :longitude])))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(defn main [{:keys [ip]}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (println &quot;Request temperature for the IP&quot; ip))</span></div></div></div></div></div><p>A resolver is like a function, with some constraints:</p><ol><li>The resolver input <strong>must</strong> be a map, so the input information is labeled.</li><li>A resolver <strong>must</strong> return a map, so the output information is labeled.</li><li>A resolver may also receive another map containing the environment information.</li></ol><p>To test the resolver in the REPL, call it like a function:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(ip-&gt;lat-long {:ip &quot;198.29.213.3&quot;})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">; =&gt; {:longitude &quot;-88.0569&quot;, :latitude &quot;41.5119&quot;}</span></div></div></div></div></div><p>A resolver is a custom type, here is what&#x27;s inside:</p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">ip-&gt;lat-long</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#com.wsscode.pathom3.connect.operation.Resolver</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{:config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> #:com.wsscode.pathom3.connect.operation</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> {:input [:ip]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  :provides {:longitude {}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             :latitude {}}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  :output [:longitude</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           :latitude]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  :op-name com.wsscode.pathom3.demos.ip-weather/ip-&gt;lat-long},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> :resolve</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> #object[com.wsscode.pathom3.demos.ip_weather$ip__GT_lat_long__17350</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         0x4b7b5266</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;com.wsscode.pathom3.demos.ip_weather$ip__GT_lat_long__17350@4b7b5266&quot;]}</span></div></div></div></div></div><p>Note that in the configuration map of the resolver, we have the same <code>::pco/output</code> as
we wrote in the resolver, while the <code>::pco/input</code> was inferred from the destructuring used in
the resolver attribute vector.</p><p>You can learn more about the details at <a href="/docs/resolvers">resolvers documentation page</a>.</p><p>Now that we have the latitude and longitude, the next resolver will find a <code>temperature</code>
from them:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(ns com.wsscode.pathom3.demos.ip-weather</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (:require</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [cheshire.core :as json]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [com.wsscode.pathom3.connect.operation :as pco]</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    [org.httpkit.client :as http]))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pco/defresolver ip-&gt;lat-long</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  [{:keys [ip]}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  {::pco/output [:latitude :longitude]}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (-&gt; (slurp (str &quot;https://get.geojs.io/v1/ip/geo/&quot; ip &quot;.json&quot;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      (json/parse-string keyword)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      (select-keys [:latitude :longitude])))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">(pco/defresolver latlong-&gt;temperature</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">  [{:keys [latitude longitude]}]</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">  {:temperature</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">   (-&gt; @(http/request</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">          {:url (str &quot;http://www.7timer.info/bin/api.pl?lon=&quot; longitude</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">                     &quot;&amp;lat=&quot; latitude</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">                     &quot;&amp;product=astro&amp;output=json&quot;)})</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">       :body</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">       (json/parse-string keyword)</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">       :dataseries first :temp2m)})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(defn main [{:keys [ip]}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (println &quot;Request temperature for the IP&quot; ip))</span></div></div></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>In <code>latlong-&gt;temperature</code> resolver, we let Pathom infer the output automatically. To use this
feature, remember that the last expression <strong>must</strong> be a map. Otherwise, Pathom will
not try to infer the output.</p></div></div><p>Testing the resolver in the REPL:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(latlong-&gt;temperature {:longitude &quot;-88.0569&quot;, :latitude &quot;41.5119&quot;})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">; =&gt; {:temperature -1}</span></div></div></div></div></div><p>The whole process chains nicely, starting from <code>ip</code> to <code>temperature</code>, like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(-&gt; {:ip &quot;198.29.213.3&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ip-&gt;lat-long</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    latlong-&gt;temperature)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">; =&gt; {:temperature -1}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="graph-traversal"></a>Graph Traversal<a aria-hidden="true" tabindex="-1" class="hash-link" href="#graph-traversal" title="Direct link to heading">#</a></h3><p>In the previous example, we were able to find the temperature starting from the IP. I
like to point all the names involved in the operation when we finished it, let&#x27;s look
at it again:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(-&gt; {:ip &quot;198.29.213.3&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ip-&gt;lat-long</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    latlong-&gt;temperature)</span></div></div></div></div></div><p>We have the <code>:ip</code> attribute in a map, and then we have <code>3</code> function names,
which dictates the step. Now we will replace all the resolver names with a single
attribute: our data demand, the <code>:temperature</code>.</p><p>It&#x27;s time to leverage the attribute relations established from the resolvers.</p><p>To do this, Pathom needs some indexes that combine the attribute relations described
by a list of resolvers. This is demonstrated in the highlighted fragments of the
following snippet:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(ns com.wsscode.pathom3.demos.ip-weather</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (:require</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [cheshire.core :as json]</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    [com.wsscode.pathom3.connect.indexes :as pci]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [com.wsscode.pathom3.connect.operation :as pco]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [org.httpkit.client :as http]))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pco/defresolver ip-&gt;lat-long</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  [{:keys [ip]}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  {::pco/output [:latitude :longitude]}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (-&gt; (slurp (str &quot;https://get.geojs.io/v1/ip/geo/&quot; ip &quot;.json&quot;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      (json/parse-string keyword)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      (select-keys [:latitude :longitude])))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pco/defresolver latlong-&gt;temperature</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  [{:keys [latitude longitude]}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  {:temperature</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   (-&gt; @(http/request</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          {:url (str &quot;http://www.7timer.info/bin/api.pl?lon=&quot; longitude</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     &quot;&amp;lat=&quot; latitude</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     &quot;&amp;product=astro&amp;output=json&quot;)})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       :body</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       (json/parse-string keyword)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       :dataseries first :temp2m)})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">(def env</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">  (pci/register [ip-&gt;lat-long</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">                 latlong-&gt;temperature]))</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(defn main [{:keys [ip]}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (println &quot;Request temperature for the IP&quot; ip))</span></div></div></div></div></div><p>Using the indexes we generated at the name of <code>env</code>, we can do the same processing
without mentioning any resolver name, using a <a href="/docs/eql">EQL Processor</a>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(p.eql/process env {:ip &quot;198.29.213.3&quot;} [:temperature])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">; 5.24</span></div></div></div></div></div><p>Note the previous snippet doesn&#x27;t include the name of any resolver!</p><p>We can move that code to our <code>main</code> function and make our program work:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-clojure codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(ns com.wsscode.pathom3.demos.ip-weather</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (:require</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [cheshire.core :as json]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [com.wsscode.pathom3.connect.indexes :as pci]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [com.wsscode.pathom3.connect.operation :as pco]</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    [com.wsscode.pathom3.interface.eql :as p.eql]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [org.httpkit.client :as http]))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pco/defresolver ip-&gt;lat-long</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  [{:keys [ip]}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  {::pco/output [:latitude :longitude]}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (-&gt; (slurp (str &quot;https://get.geojs.io/v1/ip/geo/&quot; ip &quot;.json&quot;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      (json/parse-string keyword)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      (select-keys [:latitude :longitude])))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pco/defresolver latlong-&gt;temperature</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  [{:keys [latitude longitude]}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  {:temperature</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   (-&gt; @(http/request</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          {:url (str &quot;http://www.7timer.info/bin/api.pl?lon=&quot; longitude</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     &quot;&amp;lat=&quot; latitude</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     &quot;&amp;product=astro&amp;output=json&quot;)})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       :body</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       (json/parse-string keyword)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       :dataseries first :temp2m)})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(def env</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (pci/register [ip-&gt;lat-long</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 latlong-&gt;temperature]))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(defn main [args]</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">  (let [temp (p.eql/process-one env args :temperature)]</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    (println (str &quot;It&#x27;s currently &quot; temp &quot;C at &quot; (pr-str args)))))</span></div></div></div></div></div><p>Then we can run from the command line:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># some specific IP</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">clj -X:ip-weather :ip </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&quot;198.29.213.3&quot;&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =&gt; It&#x27;s currently 8.33C at {:ip &quot;198.29.213.3&quot;}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># get from your IP</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">clj -X:ip-weather :ip </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string entity" style="color:rgb(195, 232, 141)">\&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable function" style="color:rgb(130, 170, 255)">curl</span><span class="token string variable" style="color:rgb(191, 199, 213)"> -s ifconfig.me</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string entity" style="color:rgb(195, 232, 141)">\&quot;</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =&gt; It&#x27;s currently ??C at {:ip &quot;YOUR_IP&quot;}</span></div></div></div></div></div><p>Magic? No, it&#x27;s the power of graphs!</p><p>To help understand how this works, have a look inside that <code>env</code> variable we defined (the
map on the right side):</p><div class="pathom-diagram"><p>  <img src="/assets/images/index-oir-connected-b6fd49ab417fa5fc6a1467d685e86d3c.png"></p></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>For now, let&#x27;s focus on the <code>index-oir</code>, which is the main index used to traverse
dependencies. Check the <a href="/docs/indexes">indexes page</a> to learn more about the other
indexes.</p></div></div><p>When we request the <code>:temperature</code>, Pathom looks in the index for a path to that attribute.
It depends on <code>:latitude</code> and <code>:longitude</code>, which we don&#x27;t have, but the index says you can
get it if you provide an <code>:ip</code>, which is in the data context. It&#x27;s the same path we described
before with the table column associations.</p><p>The previous paragraph described the <strong>planning</strong> process. The output of that process
is an execution graph that describes what it will take to fulfill the demand. Then it
starts running it, first figure <code>:latitude</code> and <code>:longitude</code> from <code>:ip</code>:</p><div class="pathom-diagram"><p>  <img src="/assets/images/table-run-1-22d6ff719af895ce86db9b8da06fc98c.png"></p></div><p>Then it can use <code>:latitude</code> and <code>:longitude</code> to get the <code>:temperature</code>:</p><div class="pathom-diagram"><p>  <img src="/assets/images/table-run-2-d820d7ffb0646f4bf99e199b58e8fdab.png"></p></div><p>Because our code only talks about context and demand, we can also use this command
line tool in a few other forms, like starting for latitude and longitude:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># from lat long</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">clj -X:ip-weather :latitude </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&quot;41.5119&quot;&#x27;</span><span class="token plain"> :longitude </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&quot;-88.0569&quot;&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =&gt; It&#x27;s currently 8.33C at {:latitude &quot;41.5119&quot;, :longitude &quot;-88.0569&quot;}</span></div></div></div></div></div><p>As long as you use some data that has a path to the temperature, it works.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="whats-next"></a>What&#x27;s next<a aria-hidden="true" tabindex="-1" class="hash-link" href="#whats-next" title="Direct link to heading">#</a></h2><p>This concludes this tutorial. A quick review:</p><ul><li>Map the available data you have and the data you want in terms of attributes.</li><li>Write resolvers connecting the attribute names, adding more attributes as needed.</li><li>Prepare an environment with the <a href="/docs/indexes">indexes</a>.</li><li>Use an <a href="/docs/eql">EQL Processor</a> to make the information request.</li></ul><p>I designed this demo to illustrate the basic concepts of attribute modeling and Pathom.</p><p>Here are a few exercise suggestions you can do to extend this demo:</p><ul><li>Add a resolver to tell if the temperature is cold or not, based on some cold threshold</li><li>Add a resolver to use the current user public IP when nothing else is provided.</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/wilkerlucio/pathom3-docs/edit/master/docs/tutorial.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Getting Started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/resolvers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Resolvers Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#app-setup" class="table-of-contents__link">App Setup</a></li><li><a href="#command-line-application" class="table-of-contents__link">Command Line Application</a><ul><li><a href="#start-from-the-tail" class="table-of-contents__link">Start from the tail</a></li><li><a href="#resolvers" class="table-of-contents__link">Resolvers</a></li><li><a href="#graph-traversal" class="table-of-contents__link">Graph Traversal</a></li></ul></li><li><a href="#whats-next" class="table-of-contents__link">What&#39;s next</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Presentations</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.youtube.com/watch?v=YaHiff2vZ_o" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Navigation with Pathom 3</a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=IS3i3DTUnAI" target="_blank" rel="noopener noreferrer" class="footer__link-item">Conj 2019 - The Maximal Graph</a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=yyVKf2U8YVg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Conj 2018 - Scaling Full Stack Applications</a></li><li class="footer__item"><a href="https://www.youtube.com/watch?v=r3zywlNflJI" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dutch Clojure Days 2018 - Clojure Graph APIâ€™s</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://clojurians.slack.com/messages/pathom/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2023 Wilker Lucio</div></div></div></footer></div>
<script src="/styles.488f8ab7.js"></script>
<script src="/runtime~main.868e945b.js"></script>
<script src="/main.25d8d50a.js"></script>
<script src="/1.89ba2929.js"></script>
<script src="/2.ab7b01d4.js"></script>
<script src="/3.28552344.js"></script>
<script src="/1be78505.fdabaee1.js"></script>
<script src="/46.50848efd.js"></script>
<script src="/935f2afb.b0430d98.js"></script>
<script src="/17896441.da245a3d.js"></script>
<script src="/6eb54612.693d008c.js"></script>
</body>
</html>