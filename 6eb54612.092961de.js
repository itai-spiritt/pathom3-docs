(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{105:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return u}));var a=n(0),o=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=o.a.createContext({}),p=function(e){var t=o.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},b=function(e){var t=p(e.components);return o.a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},m=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),b=p(n),m=a,u=b["".concat(i,".").concat(m)]||b[m]||d[m]||r;return n?o.a.createElement(u,l(l({ref:t},c),{},{components:n})):o.a.createElement(u,l({ref:t},c))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},236:function(e,t,n){"use strict";n.r(t),t.default="data:image/png;base64,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"},237:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/table-plan-1-2f0fb83a0f43186235d4e333d30d4760.png"},238:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/table-plan-2-1a8e40192d6ec22c13a4d6db548c21e1.png"},239:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/index-oir-connected-b6fd49ab417fa5fc6a1467d685e86d3c.png"},240:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/table-run-1-22d6ff719af895ce86db9b8da06fc98c.png"},241:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/table-run-2-d820d7ffb0646f4bf99e199b58e8fdab.png"},73:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return p}));var a=n(2),o=n(6),r=(n(0),n(105)),i={id:"tutorial",title:"Pathom Tutorial - IP Weather",sidebar_label:"Pathom Tutorial"},l={unversionedId:"tutorial",id:"tutorial",isDocsHomePage:!1,title:"Pathom Tutorial - IP Weather",description:"The task of this tutorial is to implement a series of resolvers that can tell the current",source:"@site/docs/tutorial.mdx",slug:"/tutorial",permalink:"/docs/tutorial",editUrl:"https://github.com/wilkerlucio/pathom3-docs/edit/master/docs/tutorial.mdx",version:"current",sidebar_label:"Pathom Tutorial",sidebar:"docs",previous:{title:"Getting Started",permalink:"/docs/"},next:{title:"Nouns",permalink:"/docs/nouns"}},s=[{value:"App Setup",id:"app-setup",children:[]},{value:"Command Line Application",id:"command-line-application",children:[{value:"Start from the tail",id:"start-from-the-tail",children:[]},{value:"Resolvers",id:"resolvers",children:[]},{value:"Graph Traversal",id:"graph-traversal",children:[]}]},{value:"What&#39;s next",id:"whats-next",children:[]}],c={rightToc:s};function p(e){var t=e.components,i=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},c,i,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"The task of this tutorial is to implement a series of resolvers that can tell the current\ntemperature, based on some IP address."),Object(r.b)("p",null,"To implement this, I'll use ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://get.geojs.io"}),"GeoJS")," to find the location from some\ngiven IP, and then use ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://www.7timer.info/doc.php?lang=en#api"}),"7timer")," to find the temperature."),Object(r.b)("h2",{id:"app-setup"},"App Setup"),Object(r.b)("p",null,"In this demo, I'll be using ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://clojure.org/guides/deps_and_cli"}),"Clojure Deps")," to manage the dependencies:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure",metastring:'title="deps.edn"',title:'"deps.edn"'}),'{:paths\n ["src"]\n\n :deps\n {cheshire/cheshire   {:mvn/version "5.10.0"}\n  com.wsscode/pathom3 {:mvn/version "2022.10.19-alpha"}\n  org.clojure/clojure {:mvn/version "1.11.1"}\n  http-kit/http-kit   {:mvn/version "2.5.3"}}}\n')),Object(r.b)("p",null,"We are going to use ",Object(r.b)("inlineCode",{parentName:"p"},"http-kit")," to make our requests and ",Object(r.b)("inlineCode",{parentName:"p"},"cheshire")," to parse ",Object(r.b)("inlineCode",{parentName:"p"},"JSON")," from\nthe API responses."),Object(r.b)("h2",{id:"command-line-application"},"Command Line Application"),Object(r.b)("p",null,"To run our application, we will use the ",Object(r.b)("inlineCode",{parentName:"p"},":exec-fn")," feature from ",Object(r.b)("inlineCode",{parentName:"p"},"deps.edn"),", I'll start\nsetting up the main entry point and show how to trigger it from the command line:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure"}),'(ns com.wsscode.pathom3.demos.ip-weather)\n\n(defn main [{:keys [ip]}]\n  (println "Request temperature for the IP" ip))\n')),Object(r.b)("p",null,"To test this, run the following:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"clj -X com.wsscode.pathom3.demos.ip-weather/main :ip '\"198.29.213.3\"'\n")),Object(r.b)("p",null,"To make this command shorter, add an alias to ",Object(r.b)("inlineCode",{parentName:"p"},"deps.edn"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure",metastring:'{10-13} title="deps.edn"',"{10-13}":!0,title:'"deps.edn"'}),'{:paths\n ["src"]\n\n :deps\n {cheshire/cheshire   {:mvn/version "5.10.0"}\n  com.wsscode/pathom3 {:mvn/version "2022.10.19-alpha"}\n  org.clojure/clojure {:mvn/version "1.11.1"}\n  http-kit/http-kit   {:mvn/version "2.5.3"}}\n\n ; add alias to make easier to call\n :aliases\n {:ip-weather\n  {:exec-fn com.wsscode.pathom3.demos.ip-weather/main}}}\n')),Object(r.b)("p",null,"Now we can run:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"clj -X:ip-weather :ip '\"198.29.213.3\"'\n")),Object(r.b)("p",null,"Scaffolding is done. Time to start writing some application logic."),Object(r.b)("h3",{id:"start-from-the-tail"},"Start from the tail"),Object(r.b)("p",null,"First, let's understand the data scenario for this task. If we start assuming that we know\nnothing about the services involved, we still know what we have (the IP) and what we\nwant (the temperature), we can start with this graph representation:"),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{src:n(236).default}))),Object(r.b)("p",null,"By looking at the documentation on the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://www.7timer.info/doc.php?lang=en#api"}),"7timer"),",\nI see that the temperature information is present in the\n",Object(r.b)("inlineCode",{parentName:"p"},"http://www.7timer.info/bin/api.pl?lon=$LONGITUDE$&lat=$LATITUDE$&product=astro&output=json")," endpoint\n. This means that to fetch the temperature, we need some ",Object(r.b)("inlineCode",{parentName:"p"},"latitude")," and ",Object(r.b)("inlineCode",{parentName:"p"},"longitude"),"."),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{src:n(237).default}))),Object(r.b)("p",null,"Using the GeoJS API, we can use the endpoint ",Object(r.b)("inlineCode",{parentName:"p"},"https://get.geojs.io/v1/ip/geo/$IP$.json"),"\nto figure the latitude and longitude, given some IP:"),Object(r.b)("p",null,"Now we have the complete path from the ",Object(r.b)("inlineCode",{parentName:"p"},"IP")," to the ",Object(r.b)("inlineCode",{parentName:"p"},"temperature"),"."),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{src:n(238).default}))),Object(r.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"I found those API's using the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/public-apis/public-apis"}),"Public API's"),"\nservice, I find it a great source to look for open API's to play."))),Object(r.b)("h3",{id:"resolvers"},"Resolvers"),Object(r.b)("p",null,"In Pathom, resolvers are the main building blocks express attribute relationships."),Object(r.b)("p",null,"To implement the resolvers, I'll start with the one to fetch the latitude and longitude\nfrom the IP:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure"}),'(ns com.wsscode.pathom3.demos.ip-weather\n  (:require\n    [cheshire.core :as json]\n    [com.wsscode.pathom3.connect.operation :as pco]))\n\n(pco/defresolver ip->lat-long\n  [{:keys [ip]}]\n  {::pco/output [:latitude :longitude]}\n  (-> (slurp (str "https://get.geojs.io/v1/ip/geo/" ip ".json"))\n      (json/parse-string keyword)\n      (select-keys [:latitude :longitude])))\n\n(defn main [{:keys [ip]}]\n  (println "Request temperature for the IP" ip))\n')),Object(r.b)("p",null,"A resolver is like a function, with some constraints:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"The resolver input ",Object(r.b)("strong",{parentName:"li"},"must")," be a map, so the input information is labeled."),Object(r.b)("li",{parentName:"ol"},"A resolver ",Object(r.b)("strong",{parentName:"li"},"must")," return a map, so the output information is labeled."),Object(r.b)("li",{parentName:"ol"},"A resolver may also receive another map containing the environment information.")),Object(r.b)("p",null,"To test the resolver in the REPL, call it like a function:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure"}),'(ip->lat-long {:ip "198.29.213.3"})\n; => {:longitude "-88.0569", :latitude "41.5119"}\n')),Object(r.b)("p",null,"A resolver is a custom type, here is what's inside:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure",metastring:'title="ip->lat-long"',title:'"ip->lat-long"'}),'#com.wsscode.pathom3.connect.operation.Resolver\n{:config\n #:com.wsscode.pathom3.connect.operation\n {:input [:ip]\n  :provides {:longitude {}\n             :latitude {}}\n  :output [:longitude\n           :latitude]\n  :op-name com.wsscode.pathom3.demos.ip-weather/ip->lat-long},\n\n :resolve\n #object[com.wsscode.pathom3.demos.ip_weather$ip__GT_lat_long__17350\n         0x4b7b5266\n         "com.wsscode.pathom3.demos.ip_weather$ip__GT_lat_long__17350@4b7b5266"]}\n')),Object(r.b)("p",null,"Note that in the configuration map of the resolver, we have the same ",Object(r.b)("inlineCode",{parentName:"p"},"::pco/output")," as\nwe wrote in the resolver, while the ",Object(r.b)("inlineCode",{parentName:"p"},"::pco/input")," was inferred from the destructuring used in\nthe resolver attribute vector."),Object(r.b)("p",null,"You can learn more about the details at ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/resolvers"}),"resolvers documentation page"),"."),Object(r.b)("p",null,"Now that we have the latitude and longitude, the next resolver will find a ",Object(r.b)("inlineCode",{parentName:"p"},"temperature"),"\nfrom them:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure",metastring:"{5,14-23}","{5,14-23}":!0}),'(ns com.wsscode.pathom3.demos.ip-weather\n  (:require\n    [cheshire.core :as json]\n    [com.wsscode.pathom3.connect.operation :as pco]\n    [org.httpkit.client :as http]))\n\n(pco/defresolver ip->lat-long\n  [{:keys [ip]}]\n  {::pco/output [:latitude :longitude]}\n  (-> (slurp (str "https://get.geojs.io/v1/ip/geo/" ip ".json"))\n      (json/parse-string keyword)\n      (select-keys [:latitude :longitude])))\n\n(pco/defresolver latlong->temperature\n  [{:keys [latitude longitude]}]\n  {:temperature\n   (-> @(http/request\n          {:url (str "http://www.7timer.info/bin/api.pl?lon=" longitude\n                     "&lat=" latitude\n                     "&product=astro&output=json")})\n       :body\n       (json/parse-string keyword)\n       :dataseries first :temp2m)})\n\n(defn main [{:keys [ip]}]\n  (println "Request temperature for the IP" ip))\n')),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"In ",Object(r.b)("inlineCode",{parentName:"p"},"latlong->temperature")," resolver, we let Pathom infer the output automatically. To use this\nfeature, remember that the last expression ",Object(r.b)("strong",{parentName:"p"},"must")," be a map. Otherwise, Pathom will\nnot try to infer the output."))),Object(r.b)("p",null,"Testing the resolver in the REPL:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure"}),'(latlong->temperature {:longitude "-88.0569", :latitude "41.5119"})\n; => {:temperature -1}\n')),Object(r.b)("p",null,"The whole process chains nicely, starting from ",Object(r.b)("inlineCode",{parentName:"p"},"ip")," to ",Object(r.b)("inlineCode",{parentName:"p"},"temperature"),", like this:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure"}),'(-> {:ip "198.29.213.3"}\n    ip->lat-long\n    latlong->temperature)\n; => {:temperature -1}\n')),Object(r.b)("h3",{id:"graph-traversal"},"Graph Traversal"),Object(r.b)("p",null,"In the previous example, we were able to find the temperature starting from the IP. I\nlike to point all the names involved in the operation when we finished it, let's look\nat it again:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure"}),'(-> {:ip "198.29.213.3"}\n    ip->lat-long\n    latlong->temperature)\n')),Object(r.b)("p",null,"We have the ",Object(r.b)("inlineCode",{parentName:"p"},":ip")," attribute in a map, and then we have ",Object(r.b)("inlineCode",{parentName:"p"},"3")," function names,\nwhich dictates the step. Now we will replace all the resolver names with a single\nattribute: our data demand, the ",Object(r.b)("inlineCode",{parentName:"p"},":temperature"),"."),Object(r.b)("p",null,"It's time to leverage the attribute relations established from the resolvers."),Object(r.b)("p",null,"To do this, Pathom needs some indexes that combine the attribute relations described\nby a list of resolvers. This is demonstrated in the highlighted fragments of the\nfollowing snippet:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure",metastring:"{4,26-29}","{4,26-29}":!0}),'(ns com.wsscode.pathom3.demos.ip-weather\n  (:require\n    [cheshire.core :as json]\n    [com.wsscode.pathom3.connect.indexes :as pci]\n    [com.wsscode.pathom3.connect.operation :as pco]\n    [org.httpkit.client :as http]))\n\n(pco/defresolver ip->lat-long\n  [{:keys [ip]}]\n  {::pco/output [:latitude :longitude]}\n  (-> (slurp (str "https://get.geojs.io/v1/ip/geo/" ip ".json"))\n      (json/parse-string keyword)\n      (select-keys [:latitude :longitude])))\n\n(pco/defresolver latlong->temperature\n  [{:keys [latitude longitude]}]\n  {:temperature\n   (-> @(http/request\n          {:url (str "http://www.7timer.info/bin/api.pl?lon=" longitude\n                     "&lat=" latitude\n                     "&product=astro&output=json")})\n       :body\n       (json/parse-string keyword)\n       :dataseries first :temp2m)})\n\n(def env\n  (pci/register [ip->lat-long\n                 latlong->temperature]))\n\n(defn main [{:keys [ip]}]\n  (println "Request temperature for the IP" ip))\n')),Object(r.b)("p",null,"Using the indexes we generated at the name of ",Object(r.b)("inlineCode",{parentName:"p"},"env"),", we can do the same processing\nwithout mentioning any resolver name, using a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/eql"}),"EQL Processor"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure"}),'(p.eql/process env {:ip "198.29.213.3"} [:temperature])\n; 5.24\n')),Object(r.b)("p",null,"Note the previous snippet doesn't include the name of any resolver!"),Object(r.b)("p",null,"We can move that code to our ",Object(r.b)("inlineCode",{parentName:"p"},"main")," function and make our program work:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-clojure",metastring:"{6,32-35}","{6,32-35}":!0}),'(ns com.wsscode.pathom3.demos.ip-weather\n  (:require\n    [cheshire.core :as json]\n    [com.wsscode.pathom3.connect.indexes :as pci]\n    [com.wsscode.pathom3.connect.operation :as pco]\n    [com.wsscode.pathom3.interface.eql :as p.eql]\n    [org.httpkit.client :as http]))\n\n(pco/defresolver ip->lat-long\n  [{:keys [ip]}]\n  {::pco/output [:latitude :longitude]}\n  (-> (slurp (str "https://get.geojs.io/v1/ip/geo/" ip ".json"))\n      (json/parse-string keyword)\n      (select-keys [:latitude :longitude])))\n\n(pco/defresolver latlong->temperature\n  [{:keys [latitude longitude]}]\n  {:temperature\n   (-> @(http/request\n          {:url (str "http://www.7timer.info/bin/api.pl?lon=" longitude\n                     "&lat=" latitude\n                     "&product=astro&output=json")})\n       :body\n       (json/parse-string keyword)\n       :dataseries first :temp2m)})\n\n(def env\n  (pci/register [ip->lat-long\n                 latlong->temperature]))\n\n(defn main [args]\n  (let [temp (p.eql/process-one env args :temperature)]\n    (println (str "It\'s currently " temp "C at " (pr-str args)))))\n')),Object(r.b)("p",null,"Then we can run from the command line:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'# some specific IP\nclj -X:ip-weather :ip \'"198.29.213.3"\'\n# => It\'s currently 8.33C at {:ip "198.29.213.3"}\n\n# get from your IP\nclj -X:ip-weather :ip "\\"$(curl -s ifconfig.me)\\""\n# => It\'s currently ??C at {:ip "YOUR_IP"}\n')),Object(r.b)("p",null,"Magic? No, it's the power of graphs!"),Object(r.b)("p",null,"To help understand how this works, have a look inside that ",Object(r.b)("inlineCode",{parentName:"p"},"env")," variable we defined (the\nmap on the right side):"),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{src:n(239).default}))),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"For now, let's focus on the ",Object(r.b)("inlineCode",{parentName:"p"},"index-oir"),", which is the main index used to traverse\ndependencies. Check the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/indexes"}),"indexes page")," to learn more about the other\nindexes."))),Object(r.b)("p",null,"When we request the ",Object(r.b)("inlineCode",{parentName:"p"},":temperature"),", Pathom looks in the index for a path to that attribute.\nIt depends on ",Object(r.b)("inlineCode",{parentName:"p"},":latitude")," and ",Object(r.b)("inlineCode",{parentName:"p"},":longitude"),", which we don't have, but the index says you can\nget it if you provide an ",Object(r.b)("inlineCode",{parentName:"p"},":ip"),", which is in the data context. It's the same path we described\nbefore with the table column associations."),Object(r.b)("p",null,"The previous paragraph described the ",Object(r.b)("strong",{parentName:"p"},"planning")," process. The output of that process\nis an execution graph that describes what it will take to fulfill the demand. Then it\nstarts running it, first figure ",Object(r.b)("inlineCode",{parentName:"p"},":latitude")," and ",Object(r.b)("inlineCode",{parentName:"p"},":longitude")," from ",Object(r.b)("inlineCode",{parentName:"p"},":ip"),":"),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{src:n(240).default}))),Object(r.b)("p",null,"Then it can use ",Object(r.b)("inlineCode",{parentName:"p"},":latitude")," and ",Object(r.b)("inlineCode",{parentName:"p"},":longitude")," to get the ",Object(r.b)("inlineCode",{parentName:"p"},":temperature"),":"),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{src:n(241).default}))),Object(r.b)("p",null,"Because our code only talks about context and demand, we can also use this command\nline tool in a few other forms, like starting for latitude and longitude:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'# from lat long\nclj -X:ip-weather :latitude \'"41.5119"\' :longitude \'"-88.0569"\'\n# => It\'s currently 8.33C at {:latitude "41.5119", :longitude "-88.0569"}\n')),Object(r.b)("p",null,"As long as you use some data that has a path to the temperature, it works."),Object(r.b)("h2",{id:"whats-next"},"What's next"),Object(r.b)("p",null,"This concludes this tutorial. A quick review:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Map the available data you have and the data you want in terms of attributes."),Object(r.b)("li",{parentName:"ul"},"Write resolvers connecting the attribute names, adding more attributes as needed."),Object(r.b)("li",{parentName:"ul"},"Prepare an environment with the ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/indexes"}),"indexes"),"."),Object(r.b)("li",{parentName:"ul"},"Use an ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/eql"}),"EQL Processor")," to make the information request.")),Object(r.b)("p",null,"I designed this demo to illustrate the basic concepts of attribute modeling and Pathom."),Object(r.b)("p",null,"Here are a few exercise suggestions you can do to extend this demo:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Add a resolver to tell if the temperature is cold or not, based on some cold threshold"),Object(r.b)("li",{parentName:"ul"},"Add a resolver to use the current user public IP when nothing else is provided.")))}p.isMDXComponent=!0}}]);